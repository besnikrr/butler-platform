(self.webpackChunk=self.webpackChunk||[]).push([[258],{MysZ:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>me});var l=t("ERkP"),a=t("daAW"),r=t("BhJM"),n=t("MNxq");const i={path:"/voucher",title:"Program List"},c="/voucher/programs",o="/voucher/programs/edit/details",d="/voucher/programs/edit/configs",u="/voucher/programs/details",h={path:"/voucher/programs/create/hotel",title:"Program create"},m="/voucher/codes/active",x={path:"/voucher/hotel-programs/list",title:"Hotel program list"};var j=t("pu3o"),E=t.n(j),p=t("f9Y9"),g=t("jg1C");const v=({entity:e=""})=>(0,g.jsx)("div",{className:"menu-no-permissions ui-flex center py-40",children:(0,g.jsxs)("div",{className:"ui-flex column v-center center ",children:[(0,g.jsx)(r.JO,{type:"WarningTriangle",size:30,className:"mb-10"}),(0,g.jsx)(r.ZT,{h2:!0,children:"No Permissions!"}),(0,g.jsxs)(r.ZT,{size:"small",muted:!0,className:"mt-10",children:["You have no permissions to view ",e,". Please contact you administrator!"]})]})}),C=()=>{var e;const{t:s}=(0,r.$G)(),{can:t,user:i,tenant:o}=(0,l.useContext)(r.Il),d=(0,r.h_)(n.pH.VOUCHER),u=(0,a.k6)(),[x,j]=(0,l.useState)(),[C,N]=(0,l.useState)(!0),[b,y]=(0,l.useState)(""),[T,O]=(0,l.useState)(""),[R,I]=(0,l.useState)(""),_="/hotel-programs",f=t&&t(p.g.VOUCHER.CAN_GET_HOTELS_WITH_VOUCHERS),S=t&&t(p.g.VOUCHER.CAN_CREATE_VOUCHER_PROGRAM),A=t&&t(p.g.VOUCHER.CAN_LIST_VOUCHER_PROGRAMS),U=t&&t(p.g.VOUCHER.CAN_GET_HOTEL_VOUCHER_CODES),P=e=>{u.push(e)};(0,l.useEffect)((()=>{f?(async()=>{const e=await d.get(_);j(e.data),N(!1)})():N(!1)}),[]);const D=[{name:"program type",queryParamName:"program_types",data:async()=>[{label:n.PJ.DISCOUNT,queryParamValue:n.$f.DISCOUNT},{label:n.PJ.PER_DIEM,queryParamValue:n.$f.PER_DIEM},{label:n.PJ.PRE_FIXE,queryParamValue:n.$f.PRE_FIXE}]}];(0,l.useEffect)((()=>{I(u.location.search);const e=E().parse(u.location.search.replace("?","").replace(/\|([^&]*)&?/g,"&"));e.search&&y(e.search)}),[u.location.search]);if((0,r.N7)((()=>{(async()=>{const e=E().parse(u.location.search.replace("?","").replace(/\|([^&]*)&?/g,"&"));T&&(e.search=T);let s=decodeURIComponent(E().stringify(e)).replace(/\|([^&]*)&?/g,"&");const t=await d.get(`/hotel-programs?${s}`);j(t.data),N(!1)})()}),[T,R,_,d]),(0,r.N7)((()=>{const e=setTimeout((()=>{const e=E().parse(u.location.search.replace("?","").replace(/\|([^&]*)&?/g,"&"));b?e.search=b:delete e.search;const s=E().stringify(e).replace(/\|([^&]*)&?/g,"&");u.push(`?${s}`)}),500);return()=>clearTimeout(e)}),[b]),!f)return(0,g.jsx)(v,{entity:"Hotel programs"});if(C)return(0,g.jsx)(r.rj,{gutter:0,children:(0,g.jsx)(r.Zb,{children:(0,g.jsx)(r.Od,{parts:["cardHeaderAction","divider","table"]})})});const V=A||U,H=100/(V?4:3)+"%";return(0,g.jsx)(r.rj,{gutter:0,children:(0,g.jsx)(r.X2,{children:(0,g.jsx)(r.sg,{children:(0,g.jsxs)(r.Zb,{className:"network-content",page:!0,header:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(r.ZT,{h2:!0,children:s("HOTELS_LIST")}),S&&(0,g.jsx)(r.zx,{"data-testId":"create-new",onClick:()=>u.push(h.path),children:s("CREATE_NEW")})]}),children:[(0,g.jsx)("div",{className:"voucher-toolbar",children:(0,g.jsxs)("div",{className:"voucher-toolbar-actions ui-flex start v-center",children:[(0,g.jsx)(r.x$,{columns:D,onChange:e=>{I(e),u.push(`?${e}`)},filtersString:R}),(0,g.jsx)(r.Vr,{value:b,placeholder:"Search...",onChange:e=>y(e.target.value)})]})}),(0,g.jsxs)(r.iA,{children:[(0,g.jsx)(r.ss,{children:(0,g.jsxs)(r.SC,{children:[(0,g.jsx)(r.pj,{as:"th",style:{width:H},children:s("HOTEL_NAME")}),(0,g.jsx)(r.pj,{as:"th",style:{width:H},children:s("PROGRAM_TYPES")}),(0,g.jsx)(r.pj,{as:"th",style:{width:H},children:s("NUMBER_OF_PROGRAMS")}),V&&(0,g.jsx)(r.pj,{as:"th",style:{width:H}})]})}),(0,g.jsx)(r.RM,{children:null==x||null==(e=x.result)?void 0:e.map((e=>{var t,l;return(0,g.jsxs)(r.SC,{children:[(0,g.jsx)(r.pj,{children:null==e||null==(t=e.hotel)?void 0:t.name}),(0,g.jsx)(r.pj,{children:null==e||null==(l=e.program_types)?void 0:l.map((e=>n.PJ[e])).join(", ")}),(0,g.jsx)(r.pj,{children:null==e?void 0:e.nr_programs}),V&&(0,g.jsx)(r.pj,{children:(0,g.jsx)("div",{className:"w-100 ui-flex end v-center",children:e.id&&(0,g.jsxs)(g.Fragment,{children:[A&&(0,g.jsx)(r.zx,{className:"ml-20",variant:"ghost",size:"small",onClick:()=>P(`${c}/${encodeURIComponent(e.id||"")}`),children:s("PROGRAMS")}),U&&(0,g.jsx)(r.zx,{className:"ml-20",variant:"ghost",size:"small",onClick:()=>P(`${m}/${encodeURIComponent(e.id||"")}`),children:s("CODES")})]})})})]},e.id)}))})]}),(!(null!=x&&x.result)||0===(null==x?void 0:x.result.length))&&!C&&(0,g.jsx)(r.xM,{})]})})})})},N=e=>{const{t:s}=(0,r.$G)(),t=(0,r.h_)(n.pH.VOUCHER),[a,i]=(0,l.useState)(!1);return(0,g.jsxs)(r.u_,{visible:!0,onClose:()=>e.onClose(!1),style:{minWidth:360},children:[(0,g.jsx)("h3",{children:s("DELETE_VOUCHER_PROGRAM")}),(0,g.jsx)(r.iz,{}),(0,g.jsx)("span",{children:s("CONFIRM_DELETE_VOUCHER")}),(0,g.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:30},children:[(0,g.jsx)(r.zx,{size:"large",variant:"ghost",onClick:()=>e.onClose(!1),children:s("CANCEL")}),(0,g.jsx)(r.zx,{disabled:a,size:"large",variant:"danger",style:{marginLeft:20},onClick:()=>{(async()=>{i(!0);(await t.delete(`/programs/${encodeURIComponent(e.meta.id)}`)).data.result,e.onClose(!0)})()},children:s("DELETE")})]})]})},b=e=>{const{t:s}=(0,r.$G)(),[t,a]=(0,l.useState)(!1),i=(0,r.h_)(n.pH.VOUCHER);return(0,g.jsxs)(r.u_,{visible:!0,onClose:()=>e.onClose(!1),style:{minWidth:360},children:[(0,g.jsx)("h3",{children:!0===e.meta.isActive?s("DEACTIVATE_PROGRAM"):s("ACTIVATE_PROGRAM")}),(0,g.jsx)(r.iz,{}),(0,g.jsx)("span",{children:!0===e.meta.isActive?s("CONFIRM_DEACTIVATE_PROGRAM"):s("CONFIRM_ACTIVATE_PROGRAM")}),(0,g.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:30},children:[(0,g.jsx)(r.zx,{size:"large",variant:"ghost",onClick:()=>e.onClose(!1),children:s("CANCEL")}),(0,g.jsx)(r.zx,{disabled:t,size:"large",variant:!0===e.meta.isActive?"danger":"primary",style:{marginLeft:20},onClick:()=>{(async()=>{a(!0);(await i.patch(`/programs/deactivate/${encodeURIComponent(e.meta.id)}`,{is_active:!e.meta.isActive})).data.result,e.onClose(!0)})()},children:!0===e.meta.isActive?s("DEACTIVATE"):s("ACTIVATE")})]})]})};var y=t("61cJ");function T(e){const s=[];return e.rules&&Object.values(e.rules).forEach((e=>{e.configs.forEach((e=>{const t=Object.values(e.subcategories),l=e.quantity;s.push(l+" "+t.join(" or "))}))})),s}var O=t("geiN");const R=e=>{var s,t,a,i,c,o,d;const{t:u}=(0,r.$G)(),h=(0,r.h_)(n.pH.VOUCHER),[m,x]=(0,l.useState)(!1),[j,E]=(0,l.useState)(""),{user:p}=(0,l.useContext)(r.Il),v=null==p||null==(s=p.details)||null==(t=s.roles)?void 0:t.includes(n.HB.SUPER_ADMIN),C=(null==p||null==(a=p.details)||null==(i=a.roles)||i.includes(n.HB.HOTEL_PARTNER),v?{email:null==(c=p.details)?void 0:c.email}:{}),N=v?n.Y2:n.yc,{register:b,formState:{errors:R},handleSubmit:I}=(0,O.cI)({defaultValues:C,resolver:(0,y.X)(N)});return(0,g.jsx)(r.u_,{visible:!0,onClose:()=>e.onClose(!1),style:{minWidth:568},children:(0,g.jsxs)("form",{onSubmit:I((async s=>{try{var t;x(!0);const l=await h.post("/codes/generate/pdf/vouchers",{input:{voucherCodeBulk:{hotelId:e.meta.hotelId,programId:e.meta.programId,numberOfCodes:s.numberOfCodes},email:v?s.email:null==p||null==(t=p.details)?void 0:t.email}});e.onPdfGeneration(l.data),l.data.status===n.sj.SUCCESS&&e.onClose(!0)}catch(j){E(j.response.data.error)}finally{x(!1)}})),children:[(0,g.jsx)(r.ZT,{h2:!0,className:"p-10",children:u("GENERATE_VOUCHER_CODES")}),(0,g.jsx)(r.iz,{className:"mb-20"}),(0,g.jsx)(r.X2,{className:"p-10",children:(0,g.jsxs)(r.sg,{size:7,children:[(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:u("VOUCHER_TYPE")}),(0,g.jsx)(r.ZT,{children:e.meta.voucher.type})]})}),(0,g.jsx)(r.X2,{className:"mt-15",children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:e.meta.voucher.type===n.$f.PRE_FIXE?u("VOUCHER_ITEMS"):u("VOUCHER_DISCOUNT")}),(0,g.jsx)(r.ZT,{children:(()=>{switch(e.meta.voucher.type){case n.$f.DISCOUNT:return(0,g.jsxs)(r.ZT,{children:["$",e.meta.voucher.amount," off"]});case n.$f.PER_DIEM:return(0,g.jsxs)(r.ZT,{children:[e.meta.voucher.payment_type===n.uG.PERCENTAGE?"%":"$",e.meta.voucher.amount," per day"]});case n.$f.PRE_FIXE:return(0,g.jsx)(r.ZT,{children:T(e.meta.voucher).join(", ")});default:return(0,g.jsx)(g.Fragment,{})}})()})]})}),(0,g.jsx)(r.X2,{className:"mt-15",children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:u("PAYMENT")}),(0,g.jsx)(r.ZT,{children:`${e.meta.voucher.payer===n.GT.BUTLER?"Butler":"The hotel"} pays for ${e.meta.voucher.payer_percentage}%`})]})}),(0,g.jsx)(r.X2,{className:"mt-15",children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:u("NOTES_FOR_HOTEL")}),(0,g.jsx)(r.ZT,{children:e.meta.voucher.notes})]})})]})}),(0,g.jsx)(r.iz,{className:"mb-30"}),(0,g.jsx)(r.X2,{children:(0,g.jsx)(r.sg,{offset:3,size:9,children:(0,g.jsxs)("div",{className:"pl-20",children:[v&&(0,g.jsx)(r.NI,{label:u("EMAIL"),className:"my-10",children:(0,g.jsx)(r.II,Object.assign({placeholder:u("EMAIL_TO")},b("email"),{error:null==R||null==(o=R.email)?void 0:o.message}))}),(0,g.jsx)(r.NI,{label:u("NUMBER_OF_CODES"),className:"",children:(0,g.jsx)(r.II,Object.assign({placeholder:u("NUMBER_OF_CODES_PLACEHOLDER")},b("numberOfCodes"),{type:"number",error:null==R||null==(d=R.numberOfCodes)?void 0:d.message}))})]})})}),(0,g.jsx)(r.iz,{}),(0,g.jsx)(r.X2,{children:(0,g.jsx)(r.sg,{offset:5,size:7,children:(0,g.jsxs)("div",{className:"ui-flex mt-10 end",children:[(0,g.jsx)(r.zx,{size:"large",variant:"ghost",onClick:()=>e.onClose(!1),children:u("CANCEL")}),(0,g.jsx)(r.zx,{type:"submit",disabled:m,size:"large",variant:"primary",style:{marginLeft:20},children:u(m?"GENERATING_ELLIPSIS":"GENERATE")})]})})})]})})},I=()=>{var e,s;const{t}=(0,r.$G)(),{can:i,user:c}=(0,l.useContext)(r.Il),o=(0,r.h_)(n.pH.VOUCHER),d=(0,r.h_)(n.pH.NETWORK),m=(0,a.k6)(),[x,j]=(0,l.useState)(),[C,y]=(0,l.useState)(),[T,O]=(0,l.useState)(),[I,_]=(0,l.useState)(),[f,S]=(0,l.useState)(),[A,U]=(0,l.useState)(!0),[P,D]=(0,l.useState)(!1),[V,H]=(0,l.useState)(""),[L,M]=(0,l.useState)(""),[G,Z]=(0,l.useState)(""),[w,$]=(0,l.useState)({status:"",error:""});(0,l.useEffect)((()=>{""!==w.status&&(0,r.hi)(w.error,{type:"SUCCEEDED"==w.status?"success":"error"})}),[w]);const F=(0,a.UO)(),z=`/programs/hotels/${F.hotelId}`,k=i&&i(p.g.VOUCHER.CAN_CREATE_VOUCHER_PROGRAM),W=i&&i(p.g.VOUCHER.CAN_GENERATE_VOUCHER_CODES),X=i&&i(p.g.VOUCHER.CAN_GET_SINGLE_VOUCHER_PROGRAM),Q=i&&i(p.g.VOUCHER.CAN_UPDATE_VOUCHER_PROGRAMS),B=i&&i(p.g.VOUCHER.CAN_DELETE_VOUCHER_PROGRAMS),Y=i&&i(p.g.VOUCHER.CAN_LIST_VOUCHER_PROGRAMS),J=[{name:"Status",queryParamName:"is_active",data:async()=>[{label:n.tV.ACTIVE,queryParamValue:"true"},{label:n.tV.INACTIVE,queryParamValue:"false"}]},{name:"Type",queryParamName:"types",data:async()=>[{label:n.PJ.DISCOUNT,queryParamValue:n.$f.DISCOUNT},{label:n.PJ.PER_DIEM,queryParamValue:n.$f.PER_DIEM},{label:n.PJ.PRE_FIXE,queryParamValue:n.$f.PRE_FIXE}]}];(0,l.useEffect)((()=>{Z(m.location.search);const e=E().parse(m.location.search.replace("?","").replace(/\|([^&]*)&?/g,"&"));e.search&&H(e.search)}),[m.location.search]);const q=async()=>{const e=E().parse(m.location.search.replace("?","").replace(/\|([^&]*)&?/g,"&"));L&&(e.search=L);let s=decodeURIComponent(E().stringify(e)).replace(/\|([^&]*)&?/g,"&");try{const e=await o.get(`${z}?${s}`);j(e.data)}catch(t){D(!0)}};(0,r.N7)((()=>{q()}),[L,G,z,o]),(0,r.N7)((()=>{const e=setTimeout((()=>{const e=E().parse(m.location.search.replace("?","").replace(/\|([^&]*)&?/g,"&"));V?e.search=V:delete e.search;const s=E().stringify(e).replace(/\|([^&]*)&?/g,"&");m.push(`?${s}`)}),500);return()=>clearTimeout(e)}),[V]);const K=e=>(0,g.jsx)(r.Lt,{renderTrigger:(e,s)=>(0,g.jsx)(r.Kk,{onClick:e,ref:s,children:(0,g.jsx)(r.JO,{type:"ThreeDots",size:40})}),hasArrow:!0,placement:"right",children:(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:160},children:[Q&&(0,g.jsx)(r.zx,{className:"w-100",variant:!0===(null==e?void 0:e.is_active)?"danger-ghost":"ghost",muted:!0,onClick:()=>{e.id&&_({resource:"voucher",id:e.id,isActive:e.is_active})},children:!0===(null==e?void 0:e.is_active)?t("DEACTIVATE"):t("ACTIVATE")}),B&&(0,g.jsx)(r.zx,{className:"w-100",variant:"danger-ghost",muted:!0,onClick:()=>{(e=>{e.id&&O({resource:"voucher",id:e.id})})(e)},children:t("DELETE")})]})});if((0,l.useEffect)((()=>{Y?(async()=>{await q(),await(async()=>{null==c||c.details;const e=F.hotelId,s=await d.get(`/hotels/${e}`);y(s.data)})(),U(!1)})():U(!1)}),[]),!Y||P)return(0,g.jsx)(v,{entity:"Hotel programs"});if(A)return(0,g.jsxs)(r.rj,{gutter:0,children:[(0,g.jsx)(r.Od,{className:"ml-10",parts:["header"]}),(0,g.jsx)(r.Zb,{children:(0,g.jsx)(r.Od,{parts:["title","divider","text-2","labelField-1"]})}),(0,g.jsx)("br",{}),(0,g.jsx)(r.Zb,{children:(0,g.jsx)(r.Od,{parts:["title","divider","text-2","labelField-2"]})}),(0,g.jsx)("br",{})]});const ee=Q||B;let se=4;W&&se++;const te=100/se+"%";return(0,g.jsxs)(r.rj,{gutter:0,children:[(0,g.jsx)(r.X2,{children:(0,g.jsx)(r.sg,{children:(0,g.jsx)(r.Zb,{className:"voucher-content",page:!0,header:(0,g.jsx)(r.ZT,{h2:!0,children:t("HOTEL_INFORMATION")}),children:(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:t("HOTEL_NAME")}),(0,g.jsx)(r.ZT,{children:null==C||null==(e=C.result)?void 0:e.name})]})})})})}),(0,g.jsxs)(r.X2,{children:[(0,g.jsx)(r.sg,{children:(0,g.jsxs)(r.Zb,{className:"voucher-content",page:!0,header:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(r.ZT,{h2:!0,children:t("VOUCHER_PROGRAMS")}),k&&(0,g.jsx)(r.zx,{"data-testId":"create-new",onClick:()=>m.push(`${h.path}?hotelId=${F.hotelId}`),children:t("CREATE_NEW")})]}),children:[(0,g.jsx)("div",{className:"voucher-toolbar",children:(0,g.jsxs)("div",{className:"voucher-toolbar-actions ui-flex start v-center",children:[(0,g.jsx)(r.x$,{columns:J,onChange:e=>{Z(e),m.push(`?${e}`)},filtersString:G}),(0,g.jsx)(r.Vr,{value:V,placeholder:"Search...",onChange:e=>H(e.target.value)})]})}),(0,g.jsxs)(r.iA,{children:[(0,g.jsx)(r.ss,{children:(0,g.jsxs)(r.SC,{children:[(0,g.jsx)(r.pj,{as:"th",style:{width:te},children:t("NAME")}),(0,g.jsx)(r.pj,{as:"th",style:{width:te},children:t("TYPE")}),(0,g.jsx)(r.pj,{as:"th",style:{width:te},children:t("STATUS")}),(0,g.jsx)(r.pj,{as:"th",style:{width:te},children:t("DATE_CREATED")}),W&&(0,g.jsx)(r.pj,{as:"th",style:{width:te},children:t("PDF")}),(X||B||Q)&&(0,g.jsx)(r.pj,{"data-testId":"three-dots",as:"th",style:{width:50}})]})}),(0,g.jsx)(r.RM,{children:null==x||null==(s=x.result)?void 0:s.map((e=>(0,g.jsxs)(r.SC,{children:[(0,g.jsx)(r.pj,{children:X?(0,g.jsx)(r.rU,{component:a.rU,to:`${u}/${encodeURIComponent(e.id||"")}`,children:null==e?void 0:e.name}):null==e?void 0:e.name}),(0,g.jsx)(r.pj,{children:n.PJ[null==e?void 0:e.type]}),(0,g.jsx)(r.pj,{children:(0,g.jsx)(r.Ct,{leftIcon:"Circle",iconSize:5,size:"small",className:!0===(null==e?void 0:e.is_active)?"ui-badge":"ui-badge-inactive",children:!0===(null==e?void 0:e.is_active)?t("ACTIVE"):t("INACTIVE")})}),(0,g.jsx)(r.pj,{children:(null==e?void 0:e.created_at)&&new Date(e.created_at).toDateString()}),W&&(0,g.jsx)(r.pj,{children:!0===(null==e?void 0:e.is_active)&&(0,g.jsx)(r.zx,{variant:"primary",size:"small",onClick:()=>{S({resource:"voucher",voucher:e,programId:(null==e?void 0:e.id)||"",hotelId:e.hotel.id,numberOfCodes:0})},children:t("GENERATE_CODES")})}),ee&&(0,g.jsx)(r.pj,{className:"act",children:K(e)})]},e.id)))})]}),(!(null!=x&&x.result)||0===(null==x?void 0:x.result.length))&&!A&&(0,g.jsx)(r.xM,{})]})}),T&&(0,g.jsx)(N,{meta:T,onClose:e=>{O(void 0),e&&q()}}),I&&(0,g.jsx)(b,{meta:I,onClose:e=>{_(void 0),q()}}),f&&(0,g.jsx)(R,{meta:f,onPdfGeneration:e=>{$({status:e.status,error:e.cause?"Generating voucher codes failed.":e.status})},onClose:()=>{S(void 0)}})]})]})};var _=t("KDUK");const f=({voucherProgram:e})=>{var s,t;const{t:a}=(0,r.$G)(),{can:n}=(0,l.useContext)(r.Il),i=n&&n("permission::voucher::CAN_UPDATE_VOUCHER_PROGRAMS"),c=(0,_.k6)();return(0,g.jsx)(r.X2,{children:(0,g.jsx)(r.sg,{children:(0,g.jsxs)(r.Zb,{page:!0,className:"network-content",header:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(r.ZT,{h2:!0,children:a("VOUCHER_DETAILS")}),i&&(0,g.jsx)(r.rU,{"data-testId":"edit",component:"button",size:"small",onClick:()=>{e&&e.id&&c.push(`${o}/${encodeURIComponent(null==e?void 0:e.id)}`)},children:a("EDIT")})]}),children:[(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("HOTEL_CODE")}),(0,g.jsx)(r.ZT,{children:null==e||null==(s=e.hotel)?void 0:s.code})]})}),(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("HOTEL_NAME")}),(0,g.jsx)(r.ZT,{children:null==e||null==(t=e.hotel)?void 0:t.name})]})}),(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("VOUCHER_NAME")}),(0,g.jsx)(r.ZT,{children:null==e?void 0:e.name})]})}),(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("VOUCHER_TYPE")}),(0,g.jsx)(r.ZT,{children:null==e?void 0:e.type})]})}),(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("PAYER")}),(0,g.jsx)(r.ZT,{children:null==e?void 0:e.payer})]})}),"HOTEL"===(null==e?void 0:e.payer)&&(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("PAYER_PERCENTAGE")}),(0,g.jsxs)(r.ZT,{children:[null==e?void 0:e.payer_percentage," %"]})]})}),(null==e?void 0:e.notes)&&(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("NOTES")}),(0,g.jsx)(r.ZT,{children:null==e?void 0:e.notes})]})}),(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("CODE_LIMIT_PER_DAY")}),(0,g.jsx)(r.ZT,{children:null==e?void 0:e.code_limit})]})})]})})})},S=({voucherProgram:e})=>{const{t:s}=(0,r.$G)(),{can:t}=(0,l.useContext)(r.Il),a=t&&t("permission::voucher::CAN_UPDATE_VOUCHER_PROGRAMS"),i=(0,_.k6)();return(0,g.jsx)(r.X2,{children:(0,g.jsx)(r.sg,{children:(0,g.jsx)(r.Zb,{page:!0,className:"network-content",header:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(r.ZT,{h2:!0,children:s("CONFIGS")}),e&&a&&(0,g.jsx)(r.rU,{"data-testId":"edit",component:"button",size:"small",onClick:()=>{var s;(s=e)&&s.id&&i.push(`${d}/${s.type}/${encodeURIComponent(s.id)}`)},children:s("EDIT")})]}),children:e&&(e=>{switch(e.type){case n.$f.DISCOUNT:return(e=>(0,g.jsxs)(r.X2,{children:[(0,g.jsx)(r.sg,{size:2,children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:s("PAYMENT_TYPE")}),(0,g.jsx)(r.ZT,{children:(null==e?void 0:e.payment_type)===n.uG.AMOUNT?"$":"%"})]})}),(0,g.jsx)(r.sg,{size:2,children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:s("AMOUNT")}),(null==e?void 0:e.payment_type)===n.uG.AMOUNT?(0,g.jsxs)(r.ZT,{children:["$",null==e?void 0:e.amount]}):(0,g.jsxs)(r.ZT,{children:[null==e?void 0:e.amount,"%"]})]})})]}))(e);case n.$f.PER_DIEM:return(e=>(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:s("AMOUNT")}),(0,g.jsxs)(r.ZT,{children:["$",null==e?void 0:e.amount]})]})}))(e);case n.$f.PRE_FIXE:return(e=>{var t;const l=e.rules&&(null==(t=Object.values(e.rules))?void 0:t[0]),a=null==l?void 0:l.name;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(r.X2,{children:[(0,g.jsx)(r.sg,{size:2,children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:s("MEAL_PERIOD")}),(0,g.jsx)(r.ZT,{"data-testId":"category",children:a})]})}),(0,g.jsx)(r.sg,{size:2,children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:s("PRICE")}),(0,g.jsxs)(r.ZT,{"data-testId":"amount",children:["$",e.amount]})]})})]}),(0,g.jsx)(r.iz,{}),(0,g.jsxs)(r.iA,{children:[(0,g.jsx)(r.ss,{children:(0,g.jsxs)(r.SC,{children:[(0,g.jsx)(r.pj,{as:"th",children:s("SUBCATEGORIES")}),(0,g.jsx)(r.pj,{as:"th",children:s("QUANTITY")}),(0,g.jsx)(r.pj,{as:"th",children:s("PRICE_LIMIT")})]})}),(0,g.jsx)(r.RM,{children:null==l?void 0:l.configs.map(((e,s)=>{return(0,g.jsxs)(r.SC,{children:[(0,g.jsx)(r.pj,{children:(t=e.subcategories,Object.keys(t).map((e=>t[e])).join(", "))}),(0,g.jsx)(r.pj,{children:e.quantity}),(0,g.jsx)(r.pj,{children:e.price_limit})]},s);var t}))})]})]})})(e)}})(e)})})})},A=()=>{var e;const{can:s}=(0,l.useContext)(r.Il),t=(0,r.h_)(n.pH.VOUCHER),a=(0,_.UO)(),[i,c]=(0,l.useState)(),[o,d]=(0,l.useState)(!0),u=s&&s(p.g.VOUCHER.CAN_GET_SINGLE_VOUCHER_PROGRAM);return(0,l.useEffect)((()=>{(async()=>{const e=await t.get(`/programs/${a.id}`);console.log("========= result",e),console.log("========= typeof result",typeof e),console.log("========= result?.data",null==e?void 0:e.data),e&&e.data&&(c(null==e?void 0:e.data),d(!1))})()}),[a.id]),u&&403!==(null==i?void 0:i.status)?o?(0,g.jsxs)(r.rj,{gutter:0,children:[(0,g.jsx)(r.Od,{className:"ml-10",parts:["header"]}),(0,g.jsx)(r.Zb,{children:(0,g.jsx)(r.Od,{parts:["title","divider","text-2","labelField-1"]})}),(0,g.jsx)("br",{}),(0,g.jsx)(r.Zb,{children:(0,g.jsx)(r.Od,{parts:["title","divider","text-2","labelField-2"]})}),(0,g.jsx)("br",{})]}):null!=i&&i.result?(0,g.jsxs)(r.rj,{gutter:0,children:[(0,g.jsx)("div",{className:"ui-flex between v-center mb-30 px-30",children:(0,g.jsx)(r.ZT,{h2:!0,children:null==i||null==(e=i.result)?void 0:e.name})}),(0,g.jsx)(f,{voucherProgram:null==i?void 0:i.result}),(0,g.jsx)(S,{voucherProgram:null==i?void 0:i.result})]}):(0,g.jsx)(r.rj,{gutter:0,className:"ui-flex center",children:(0,g.jsx)(r.xM,{})}):(0,g.jsx)(v,{entity:"Voucher program"})},U=({useForm:e})=>{var s;const{t}=(0,r.$G)(),{register:a,formState:{errors:i}}=e,[c,o]=(0,l.useState)("$"),[d,u]=(0,l.useState)("0.00");return(0,g.jsxs)(r.cw,{children:[(0,g.jsx)(r.NI,{label:t("PAYMENT_TYPE"),children:(0,g.jsxs)(r.Ph,{selectProps:Object.assign({},a("payment_type"),{onChange:s=>{const t=s.target.value;e.setValue("payment_type",t),e.resetField("amount"),t===n.uG.PERCENTAGE?(u("0"),o("%")):(u("0.00"),o("$"))}}),children:[(0,g.jsx)(r.Wx,{value:"",disabled:!0,hidden:!0,children:t("PAYMENT_TYPE")}),(0,g.jsx)(r.Wx,{value:n.uG.AMOUNT,children:"$"}),(0,g.jsx)(r.Wx,{value:n.uG.PERCENTAGE,children:"%"})]})}),(0,g.jsx)(r.NI,{label:t("DISCOUNT"),children:(0,g.jsx)(r.II,Object.assign({type:"number",step:"any",prefixNode:c,placeholder:d,className:"w-100"},a("amount"),{error:null==i||null==(s=i.amount)?void 0:s.message}))})]})},P=({useForm:e})=>{var s;const{t}=(0,r.$G)(),{register:l,formState:{errors:a}}=e;return(0,g.jsx)(r.NI,{label:t("AMOUNT_USD"),children:(0,g.jsx)(r.II,Object.assign({type:"number",prefixNode:"$",step:"any",placeholder:"0.00",className:"w-100"},l("amount"),{error:null==a||null==(s=a.amount)?void 0:s.message}))})},D=({useForm:e})=>{var s;const{t}=(0,r.$G)(),a=(0,r.h_)(n.pH.MENU),{register:i,unregister:c,formState:{errors:o},setValue:d,reset:u}=e,[h,m]=(0,l.useState)(),[x,j]=(0,l.useState)(),[E,p]=(0,l.useState)(null),v=e=>{const s={rules:{}};Object.keys(e).forEach((e=>{s.rules&&(s.rules[e]={configs:[{price_limit:0,quantity:0,subcategories:{}}]})})),j(s)};(0,l.useEffect)((()=>{console.log("MAIN-CALLED"),(async()=>{var e,s;const t=await a.get("/subcategories"),l=(null==t||null==(e=t.data)?void 0:e.result)&&(e=>{const s={};return e.forEach((e=>{s[e.category.id]?s[e.category.id].subcategories.push(e):s[e.category.id]={subcategories:[e],name:e.category.name}})),s})(null==t||null==(s=t.data)?void 0:s.result);l&&(console.log("categorySubcategory",l),m(l),v(l))})()}),[]),(0,l.useEffect)((()=>{console.log("SECOND-CALLED"),h&&v(h)}),[E]),(0,l.useEffect)((()=>{N()}),[x]);const C=e=>(e=>{const s=E&&h&&h[E];return null!=s&&s.subcategories?s.subcategories.map((e=>e.id&&{key:e.id,value:e.name})):[]})().map((e=>(0,g.jsx)(r.Wx,{value:e.key,children:e.value}))),N=()=>{var e,s,l,a;let n=1;return E&&x&&(null==x||null==(e=x.rules)||null==(s=e[E])?void 0:s.configs)&&(null==x||null==(l=x.rules[E])||null==(a=l.configs)?void 0:a.map(((e,s)=>{var l,a,c,u,h,m;return e&&(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"ui-flex between mt-30 mb-10",children:[(0,g.jsxs)(r.ZT,{p:!0,children:["Condition ",n++]}),(0,g.jsx)(r.zx,{type:"button",variant:"danger-ghost",size:"small",id:`${s}`,onClick:b,children:(0,g.jsx)(r.JO,{type:"Delete",size:16})})]}),(0,g.jsx)(r.NI,{label:"Categories",className:"w-100 my-10",children:(0,g.jsx)(r.Ph,{multiple:!0,selectProps:{onChange:e=>{var t,l;((e,s,t)=>{if(s){s.subcategories={};for(let t=0;t<e.target.options.length;t++){const l=e.target.options[t];l.selected&&(s.subcategories[l.value]=l.text)}d(`configs[${t}].subcategories`,JSON.stringify(s.subcategories))}})(e,null==x||null==(t=x.rules)||null==(l=t[E])?void 0:l.configs[s],s)}},placeholder:"Select Categories",children:C()})}),(0,g.jsxs)(r.cw,{className:"ui-flex between my-10",children:[(0,g.jsx)(r.NI,{label:t("QUANTITY"),children:(0,g.jsx)(r.II,Object.assign({type:"number"},i(`configs[${s}].quantity`),{placeholder:"0",error:null==o||null==(l=o.configs)||null==(a=l[s])||null==(c=a.quantity)?void 0:c.message,min:0}))}),(0,g.jsx)(r.NI,{label:t("PRICE_LIMIT"),children:(0,g.jsx)(r.II,Object.assign({prefixNode:"$",placeholder:"0.00",type:"number"},i(`configs[${s}].price_limit`),{error:null==o||null==(u=o.configs)||null==(h=u[s])||null==(m=h.price_limit)?void 0:m.message}))})]})]},`item-${e.id}-${s}`)})))},b=e=>{const s=e.currentTarget.id;c(`configs[${s}]`);const t=Object.assign({},x);var l,a;E&&(null==t||(null==(l=t.rules)||(null==(a=l[E])||delete a.configs[s])));j(t)};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(r.cw,{className:"my-10",children:[(0,g.jsx)(r.NI,{className:"category-wrapper",children:(0,g.jsxs)(r.Ph,Object.assign({value:E||""},i("main_category"),{selectProps:{onChange:e=>{return s=e.currentTarget.value,p(s),d("configs",[]),void Object.keys(h).forEach((e=>{null!=x&&x.rules&&(x.rules[e]={name:"",configs:[]})}));var s}},children:[(0,g.jsx)(r.Wx,{value:"",hidden:!0,disabled:!0,children:t("SELECT_CATEGORY")}),x&&h&&Object.keys(h).map((e=>(0,g.jsx)(r.Wx,{value:e,children:h[e].name},e)))]}))}),(0,g.jsx)(r.NI,{label:t("PRICE"),children:(0,g.jsx)(r.II,Object.assign({type:"number",prefixNode:"$",placeholder:"0.00",className:"w-100"},i("amount"),{error:null==o||null==(s=o.amount)?void 0:s.message}))})]}),E&&x&&N(),E&&(0,g.jsx)(r.zx,{type:"button",variant:"ghost",size:"small",onClick:()=>{j((e=>{var s,t;if(!E)return e;const l=null!=e&&null!=(s=e.rules)&&null!=(t=s[E])&&t.configs?[...null==e?void 0:e.rules[E].configs]:[];return l.push({subcategories:{},quantity:0,price_limit:0}),Object.assign({},e,{rules:{[E]:{configs:l}}})}))},leftIcon:(0,g.jsx)(r.JO,{type:"Plus",size:20}),className:"mt-20",children:"Add Another Condition"})]})},V=({useForm:e})=>{var s,t;const{t:a}=(0,r.$G)(),[i,c]=(0,l.useState)();return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(r.NI,{label:a("VOUCHER_TYPE"),className:"my-10 type-wrapper",children:(0,g.jsxs)(r.Ph,{value:null!=i?i:"",selectProps:{onChange:s=>{e.setValue("type",s.currentTarget.value),e.resetField("amount"),e.clearErrors("type"),c(s.currentTarget.value)}},error:null==(s=e.formState.errors)||null==(t=s.type)?void 0:t.message,children:[(0,g.jsx)(r.Wx,{value:"",disabled:!0,hidden:!0,selected:!0,children:a("SELECT_VOUCHER_TYPE")}),Object.keys(n.$f).map((e=>(0,g.jsx)(r.Wx,{value:e,children:e})))]})}),(s=>{switch(s){case n.$f.DISCOUNT:return(0,g.jsx)(U,{useForm:e});case n.$f.PER_DIEM:return(0,g.jsx)(P,{useForm:e});case n.$f.PRE_FIXE:return(0,g.jsx)(D,{useForm:e});default:return null}})(i||"")]})},H=({hotels:e,useForm:s,hotelId:t,setIsFormChanged:a})=>{var i,c,o,d;const{t:u}=(0,r.$G)(),[h,m]=(0,l.useState)(""),{register:x,formState:{errors:j},watch:E,setValue:p,reset:v}=s;(0,_.k6)();return(0,l.useEffect)((()=>{const e=E(((e,{name:s})=>{s&&a(!0)}));return()=>e.unsubscribe()}),[E]),(0,l.useEffect)((()=>{v({hotel_id:t||"",payer:n.GT.BUTLER,payer_percentage:100,code_limit:100})}),[]),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(r.NI,{label:u("VOUCHER_PROGRAM"),className:"my-10",children:(0,g.jsx)(r.II,Object.assign({placeholder:u("ENTER_VOUCHER_PROGRAM_NAME")},x("name"),{error:null==j||null==(i=j.name)?void 0:i.message}))}),(0,g.jsx)(r.NI,{label:u("HOTEL"),className:"my-10",children:(0,g.jsxs)(r.Ph,{value:"",disabled:!!t,selectProps:Object.assign({},x("hotel_id")),error:null==j||null==(c=j.hotel_id)?void 0:c.message,children:[(0,g.jsx)(r.Wx,{value:"",disabled:!0,hidden:!0,children:u("SELECT_HOTEL")}),(e=>{var s;return e&&(null==e||null==(s=e.result)?void 0:s.map((e=>(0,g.jsx)(r.Wx,{value:e.id,children:e.name},e.id))))})(e)]})}),(0,g.jsx)(r.NI,{label:u("PAYER"),className:"my-10",children:(0,g.jsxs)(r.Ph,{value:"",selectProps:Object.assign({},x("payer"),{onChange:e=>{m(e.target.value),p("payer",e.target.value),p("payer_percentage",e.target.value===n.GT.BUTLER?100:null)}}),children:[(0,g.jsx)(r.Wx,{value:n.GT.BUTLER,children:n.GT.BUTLER}),(0,g.jsx)(r.Wx,{value:n.GT.HOTEL,children:n.GT.HOTEL})]})}),(0,g.jsx)(r.NI,{label:u("PAYER_PERCENTAGE"),className:"my-10",children:(0,g.jsx)(r.II,Object.assign({placeholder:u("PAYER_PERCENTAGE"),type:"number",min:"0",max:"100",disabled:h!==n.GT.HOTEL},x("payer_percentage"),{error:null==j||null==(o=j.payer_percentage)?void 0:o.message}))}),(0,g.jsx)(r.NI,{label:u("NOTES"),className:"my-10",children:(0,g.jsx)(r.gx,Object.assign({},x("notes")))}),(0,g.jsx)(r.NI,{label:u("CODE_LIMIT_PER_DAY"),className:"my-10",children:(0,g.jsx)(r.II,Object.assign({placeholder:u("CODE_LIMIT"),type:"number",min:"0"},x("code_limit"),{error:null==j||null==(d=j.code_limit)?void 0:d.message}))})]})},L=()=>{const{t:e}=(0,r.$G)(),s=(0,r.h_)(n.pH.VOUCHER),t=(0,r.h_)(n.pH.NETWORK),i=(0,a.k6)(),c=(0,a.TH)(),[o,d]=(0,l.useState)(!1),[h,m]=(0,l.useState)(""),[j,E]=(0,l.useState)(),[C,N]=(0,l.useState)(!0),[b,T]=(0,l.useState)(),{can:R}=(0,l.useContext)(r.Il),I=R&&R(p.g.VOUCHER.CAN_CREATE_VOUCHER_PROGRAM),[_,f]=(0,l.useState)(!1),[S,A]=(0,l.useState)(!1),U=(0,O.cI)({resolver:(0,y.X)(n.mE)});(0,l.useEffect)((()=>{const e=new URLSearchParams(c.search).get("hotelId");T(e||"");(async()=>{const e=await t.get("/hotels");E(e.data),N(!1)})()}),[]);return I?C?(0,g.jsxs)(r.rj,{gutter:0,children:[(0,g.jsx)(r.Od,{className:"ml-10",parts:["title"]}),(0,g.jsx)(r.Zb,{children:(0,g.jsx)(r.Od,{parts:["title","divider","text-2","labelField-1"]})})]}):(0,g.jsx)(r.rj,{gutter:0,children:(0,g.jsx)("form",{onSubmit:U.handleSubmit((async e=>{try{var t,l,a,r,c;if(d(!0),e.type===n.$f.PRE_FIXE)e.configs=e.configs&&(null==(c=e.configs)?void 0:c.filter((e=>(e.price_limit=Number(e.price_limit),e.quantity=Number(e.quantity),e.subcategories=JSON.parse(e.subcategories),e))));const o=await s.post("/programs",e);null!=o&&null!=(t=o.data)&&null!=(l=t.result)&&l.id?i.push(`${u}/${encodeURIComponent((null==o||null==(a=o.data)||null==(r=a.result)?void 0:r.id)||"")}`):i.push(`${x}`)}catch(h){m(h.message)}finally{d(!1)}})),children:(0,g.jsx)(r.X2,{children:(0,g.jsx)(r.Zb,{className:"network-content",page:!0,header:(0,g.jsx)("div",{children:(0,g.jsx)(r.ZT,{h2:!0,children:e("CREATE_VOUCHER")})}),children:(0,g.jsxs)(r.X2,{children:[(0,g.jsx)(r.sg,{offset:3,size:6,children:j&&(0,g.jsx)(H,{hotels:j,useForm:U,hotelId:b||"",setIsFormChanged:A})}),(0,g.jsx)(r.sg,{offset:3,size:6,children:(0,g.jsx)(r.iz,{vertical:0})}),(0,g.jsx)(r.sg,{offset:3,size:6,children:(0,g.jsx)(V,{useForm:U})}),(0,g.jsx)(r.sg,{offset:3,size:6,children:(0,g.jsxs)("div",{className:"form-bottom-action",children:[(0,g.jsx)(r.zx,{variant:"ghost",type:"button",onClick:()=>{var e;e="/voucher/hotel-programs/list",S?f(!0):i.push(e)},children:e("CANCEL")}),(0,g.jsx)(r.zx,{variant:"primary",type:"submit",disabled:o,children:e("CREATE")})]})}),(0,g.jsx)(r.RZ,{modal:_,setModal:f,onLeave:()=>i.push("/voucher/hotel-programs/list")})]})})})})}):(0,g.jsx)(v,{entity:"Create voucher program"})},M=()=>{var e,s,t;const{t:i}=(0,r.$G)(),c=(0,r.h_)(n.pH.VOUCHER),o=(0,a.k6)(),[d,h]=(0,l.useState)(!1),[m,x]=(0,l.useState)(""),[j,E]=(0,l.useState)(""),p=(0,a.UO)(),[v,C]=(0,l.useState)(),[N,b]=(0,l.useState)(),[T,R]=(0,l.useState)(!0),[I,_]=(0,l.useState)(!1),[f,S]=(0,l.useState)(!1),{register:A,handleSubmit:U,formState:{errors:P},setValue:D,reset:V,watch:H}=(0,O.cI)({resolver:(0,y.X)(n.pj)});(0,l.useEffect)((()=>{const e=H(((e,{name:s})=>{s&&S(!0)}));return()=>e.unsubscribe()}),[H]),(0,l.useEffect)((()=>{(async()=>{var e;const s=await c.get(`/programs/${p.id}`),t=null==s||null==(e=s.data)?void 0:e.result;if(t&&(C(t),x(t.payer),null!=t&&t.hotel&&b(t.hotel),t)){const{name:e,payer:s,payer_percentage:l,code_limit:a,notes:r}=t;V({name:e,payer:s,payer_percentage:l,code_limit:a,notes:r})}R(!1)})()}),[]);return T?(0,g.jsxs)(r.rj,{gutter:0,children:[(0,g.jsx)(r.Od,{className:"ml-10",parts:["header"]}),(0,g.jsx)(r.Zb,{children:(0,g.jsx)(r.Od,{parts:["title","divider","text-2","labelField-1"]})})]}):(0,g.jsx)(r.rj,{gutter:0,children:(0,g.jsx)("form",{onSubmit:U((async e=>{try{h(!0),await c.patch(`/programs/${encodeURIComponent(p.id)}`,e),o.push(`${u}/${encodeURIComponent(p.id)}`)}catch(j){E(j.message)}finally{h(!1)}})),children:(0,g.jsx)(r.X2,{children:(0,g.jsx)(r.Zb,{className:"network-content",page:!0,header:(0,g.jsx)("div",{children:(0,g.jsx)(r.ZT,{h2:!0,children:null==v?void 0:v.name})}),children:(0,g.jsxs)(r.X2,{children:[(0,g.jsxs)(r.sg,{offset:3,size:6,children:[(0,g.jsx)(r.NI,{label:i("HOTEL_CODE"),className:"my-10",children:(0,g.jsx)(r.II,{value:N&&N.code,disabled:!0})}),(0,g.jsx)(r.NI,{label:i("HOTEL_NAME"),className:"my-10",children:(0,g.jsx)(r.II,{value:N&&N.name,disabled:!0})}),(0,g.jsx)(r.NI,{label:i("VOUCHER_PROGRAM"),className:"my-10",children:(0,g.jsx)(r.II,Object.assign({placeholder:i("ENTER_VOUCHER_PROGRAM_NAME")},A("name"),{error:null==P||null==(e=P.name)?void 0:e.message}))}),(0,g.jsx)(r.NI,{label:i("PAYER"),className:"my-10",children:(0,g.jsxs)(r.Ph,{value:"",selectProps:Object.assign({},A("payer"),{onChange:e=>{x(e.target.value),D("payer",e.target.value),D("payer_percentage",e.target.value===n.GT.BUTLER?100:0)}}),children:[(0,g.jsx)(r.Wx,{value:"",disabled:!0,hidden:!0,children:"Payer"}),(0,g.jsx)(r.Wx,{value:n.GT.BUTLER,children:n.GT.BUTLER}),(0,g.jsx)(r.Wx,{value:n.GT.HOTEL,children:n.GT.HOTEL})]})}),(0,g.jsx)(r.NI,{label:i("PAYER_PERCENTAGE"),className:"my-10",children:(0,g.jsx)(r.II,Object.assign({placeholder:i("PAYER_PERCENTAGE"),type:"number",min:"0",max:"100"},A("payer_percentage"),{disabled:m===n.GT.BUTLER,error:null==P||null==(s=P.payer_percentage)?void 0:s.message}))}),(0,g.jsx)(r.NI,{label:i("NOTES"),className:"my-10",children:(0,g.jsx)(r.gx,Object.assign({},A("notes")))}),(0,g.jsx)(r.NI,{label:i("CODE_LIMIT_PER_DAY"),className:"my-10",children:(0,g.jsx)(r.II,Object.assign({placeholder:i("CODE_LIMIT"),type:"number",min:"0"},A("code_limit"),{error:null==P||null==(t=P.code_limit)?void 0:t.message}))}),(0,g.jsxs)("div",{className:"form-bottom-action mt-30",children:[(0,g.jsx)(r.zx,{variant:"ghost",type:"button",onClick:()=>{var e;e=`${u}/${encodeURIComponent(p.id)}`,f?_(!0):o.push(e)},children:i("CANCEL")}),(0,g.jsx)(r.zx,{variant:"primary",type:"submit",disabled:d,children:i("UPDATE")})]})]}),(0,g.jsx)(r.RZ,{modal:I,setModal:_,onLeave:()=>o.push(`${u}/${encodeURIComponent(p.id)}`)})]})})})})})},G=({voucherProgram:e})=>{var s;const{t}=(0,r.$G)(),i=(0,r.h_)(n.pH.VOUCHER),c=(0,a.k6)(),[o,d]=(0,l.useState)(!1),[h,m]=(0,l.useState)("$"),[x,j]=(0,l.useState)("0.00"),[E,p]=(0,l.useState)(""),v=(0,a.UO)(),[C,N]=(0,l.useState)(!1),[b,T]=(0,l.useState)(!1),{register:R,handleSubmit:I,watch:_,formState:{errors:f},setValue:S,reset:A}=(0,O.cI)({resolver:(0,y.X)(n.wX)});(0,l.useEffect)((()=>{const e=_(((e,{name:s})=>{s&&T(!0)}));return()=>e.unsubscribe()}),[_]),(0,l.useEffect)((()=>{A({amount:null==e?void 0:e.amount,payment_type:null==e?void 0:e.payment_type})}),[]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("form",{onSubmit:I((async e=>{try{d(!0),await i.patch(`/programs/${encodeURIComponent(v.id)}`,Object.assign({},e,{type:n.$f.DISCOUNT})),c.push(`${u}/${encodeURIComponent(v.id)}`)}catch(E){p(E.message)}finally{d(!1)}})),children:[(0,g.jsxs)(r.cw,{children:[(0,g.jsx)(r.NI,{label:t("PAYMENT_TYPE"),className:"my-10",children:(0,g.jsxs)(r.Ph,{selectProps:Object.assign({},R("payment_type"),{onChange:e=>{const s=e.target.value;S("payment_type",s),S("amount",null),s===n.uG.PERCENTAGE?(j("0"),m("%")):(j("0.00"),m("$"))}}),children:[(0,g.jsx)(r.Wx,{value:"",disabled:!0,hidden:!0,children:"Payment type"}),(0,g.jsx)(r.Wx,{value:"AMOUNT",children:"$"}),(0,g.jsx)(r.Wx,{value:"PERCENTAGE",children:"%"})]})}),(0,g.jsx)(r.NI,{label:t("DISCOUNT"),children:(0,g.jsx)(r.II,Object.assign({type:"number",step:"any",prefixNode:h,placeholder:x,className:"w-100"},R("amount"),{error:null==f||null==(s=f.amount)?void 0:s.message}))})]}),(0,g.jsxs)("div",{className:"form-bottom-action mt-20",children:[(0,g.jsx)(r.zx,{variant:"ghost",onClick:()=>{var e;e=`${u}/${encodeURIComponent(v.id)}`,b?N(!0):c.push(e)},children:t("CANCEL")}),(0,g.jsx)(r.zx,{variant:"primary",type:"submit",disabled:o,children:t("UPDATE")})]})]}),(0,g.jsx)(r.RZ,{modal:C,setModal:N,onLeave:()=>c.push(`${u}/${encodeURIComponent(v.id)}`)}),E&&(0,g.jsx)("span",{children:E})]})},Z=({voucherProgram:e})=>{var s;const{t}=(0,r.$G)(),i=(0,r.h_)(n.pH.VOUCHER),c=(0,a.k6)(),[o,d]=(0,l.useState)(!1),[h,m]=(0,l.useState)(""),x=(0,a.UO)(),[j,E]=(0,l.useState)(!1),[p,v]=(0,l.useState)(!1),{register:C,handleSubmit:N,formState:{errors:b},watch:T,setValue:R,reset:I,control:_}=(0,O.cI)({resolver:(0,y.X)(n.Jh)});(0,l.useEffect)((()=>{const e=T(((e,{name:s})=>{s&&v(!0)}));return()=>e.unsubscribe()}),[T]),(0,l.useEffect)((()=>{I({amount:null==e?void 0:e.amount})}),[]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("form",{onSubmit:N((async e=>{try{d(!0),await i.patch(`/programs/${encodeURIComponent(x.id)}`,Object.assign({},e,{type:n.$f.PER_DIEM})),c.push(`${u}/${encodeURIComponent(x.id)}`)}catch(h){m(h.message)}finally{d(!1)}})),children:[(0,g.jsx)(r.NI,{label:t("AMOUNT_USD"),className:"my-10",children:(0,g.jsx)(r.II,Object.assign({type:"number",prefixNode:"$",step:"any",placeholder:"0.00",className:"w-100"},C("amount"),{error:null==b||null==(s=b.amount)?void 0:s.message}))}),(0,g.jsxs)("div",{className:"form-bottom-action mt-30",children:[(0,g.jsx)(r.zx,{variant:"ghost",onClick:()=>{var e;e=`${u}/${encodeURIComponent(x.id)}`,p?E(!0):c.push(e)},children:t("CANCEL")}),(0,g.jsx)(r.zx,{variant:"primary",type:"submit",disabled:o,children:t("UPDATE")})]})]}),(0,g.jsx)(r.RZ,{modal:j,setModal:E,onLeave:()=>c.push(`${u}/${encodeURIComponent(x.id)}`)}),h&&(0,g.jsx)("span",{children:h})]})},w=({voucherProgram:e})=>{var s;const{t}=(0,r.$G)(),i=(0,r.h_)(n.pH.VOUCHER),c=(0,r.h_)(n.pH.MENU),o=(0,a.k6)(),[d,h]=(0,l.useState)(!1),[m,x]=(0,l.useState)(""),[j,E]=(0,l.useState)(""),[p,v]=(0,l.useState)(),[C,N]=(0,l.useState)(),b=(0,a.UO)(),[T,R]=(0,l.useState)(!1),[I,_]=(0,l.useState)(!1),{register:f,unregister:S,handleSubmit:A,formState:{errors:U},watch:P,setValue:D,reset:V,getValues:H}=(0,O.cI)({resolver:(0,y.X)(n.BG)});(0,l.useEffect)((()=>{const e=P(((e,{name:s})=>{s&&_(!0)}));return()=>e.unsubscribe()}),[P]);const L=e=>{var s;const t=p&&p[j];return t&&(null==t?void 0:t.subcategories)&&(null==t||null==(s=t.subcategories)?void 0:s.map((s=>({key:s.id,value:s.name,selected:Object.keys(e.subcategories||{}).includes(s.id+"")}))))};(0,l.useEffect)((()=>{N(e),(async()=>{var s;const t=await c.get("/subcategories"),l=Object.keys(null==e?void 0:e.rules)[0];v((e=>{const s={};return null==e||e.forEach((e=>{s[e.category.id]?s[e.category.id].subcategories.push(e):s[e.category.id]={subcategories:[e],name:e.category.name}})),s})((null==t||null==(s=t.data)?void 0:s.result)||[])),E(l),V({amount:null==e?void 0:e.amount,configs:null==e?void 0:e.rules[l].configs.map((e=>Object.assign({},e,{subcategories:JSON.stringify(e.subcategories)})))})})()}),[]),(0,l.useEffect)((()=>{j&&C&&G()}),[C]);const M=(e,s)=>(L(e)||[]).map((e=>(0,g.jsx)(r.Wx,{value:e.key,children:e.value},e.key))),G=()=>{var e,s;let t=1;return null==C||null==(e=C.rules)||null==(s=e[j].configs)?void 0:s.map(((e,s)=>{var l,a,n,i,c,o;return e&&(0,g.jsxs)("div",{className:"condition",children:[(0,g.jsxs)("div",{className:"ui-flex between mt-30 mb-10",children:[(0,g.jsxs)(r.ZT,{p:!0,children:["Condition ",t++]}),(0,g.jsx)(r.zx,{type:"button",variant:"danger-ghost",size:"small",id:`${s}`,onClick:Z,children:(0,g.jsx)(r.JO,{type:"Delete",size:16})})]}),(0,g.jsx)(r.NI,{label:"Categories",className:"w-100 my-10",children:(0,g.jsx)(r.Ph,{placeholder:"Select Category",multiple:!0,selectProps:Object.assign({},f(`configs[${s}].subcategories`),{onChange:e=>{var t,l;((e,s,t)=>{s.subcategories={};for(let l=0;l<e.target.options.length;l++){const t=e.target.options[l];t.selected&&(s.subcategories[t.value]=t.text)}D(`configs[${t}].subcategories`,JSON.stringify(s.subcategories))})(e,null==C||null==(t=C.rules)||null==(l=t[j])?void 0:l.configs[s],s)}}),children:M(e)})}),(0,g.jsxs)(r.cw,{className:"ui-flex between my-10",children:[(0,g.jsx)(r.NI,{label:"Quantity",children:(0,g.jsx)(r.II,Object.assign({type:"number"},f(`configs[${s}].quantity`),{placeholder:"0",error:null==U||null==(l=U.configs)||null==(a=l[s])||null==(n=a.quantity)?void 0:n.message}))}),(0,g.jsx)(r.NI,{label:"Price limit",children:(0,g.jsx)(r.II,Object.assign({prefixNode:"$",placeholder:"0.00",type:"number"},f(`configs[${s}].price_limit`),{error:null==U||null==(i=U.configs)||null==(c=i[s])||null==(o=c.price_limit)?void 0:o.message}))})]})]},`item-${e.id}-${s}`)}))},Z=e=>{const s=e.currentTarget.id;S(`configs[${s}]`);const t=Object.assign({},C);delete t.rules[j].configs[s],N(t)};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("form",{onSubmit:A((async e=>{try{let e=H();e.configs=e.configs&&e.configs.filter((e=>(e&&(e.subcategories=JSON.parse(e.subcategories),e.quantity=Number(e.quantity),e.price_limit=Number(e.price_limit)),e))),h(!0),await i.patch(`/programs/${encodeURIComponent(b.id)}`,Object.assign({},e,{type:n.$f.PRE_FIXE,amount:+e.amount})),o.push(`${u}/${encodeURIComponent(b.id)}`)}catch(m){x(m.message)}finally{h(!1)}})),children:[(0,g.jsxs)(r.cw,{className:" my-10",children:[(0,g.jsx)(r.NI,{label:t("MEAL_PERIOD"),className:"category-wrapper",children:(0,g.jsxs)(r.Ph,Object.assign({value:""},f("main_category"),{selectProps:{onChange:s=>{return t=s.currentTarget.value,delete C.rules[j],E(t),Object.keys(p).forEach((e=>{C.rules[e]={name:"",configs:[]}})),void V({amount:null==e?void 0:e.amount,configs:[]});var t}},children:[(0,g.jsx)(r.Wx,{value:"",hidden:!0,children:t("SELECT_MEAL_PERIOD")}),j&&p&&Object.keys(p).map((e=>(0,g.jsx)(r.Wx,{value:e,selected:e===j,children:p[e].name})))]}))}),(0,g.jsx)(r.NI,{label:t("PRICE"),children:(0,g.jsx)(r.II,Object.assign({type:"number",step:"any"},f("amount"),{error:null==(s=U.amount)?void 0:s.message,className:"w-100"}))})]}),(0,g.jsx)("div",{className:"conditions-wrapper",children:j&&C&&G()}),(0,g.jsx)(r.zx,{type:"button",variant:"ghost",size:"small",onClick:()=>{N((e=>Object.assign({},e,{rules:{[j]:{configs:[...null==e?void 0:e.rules[j].configs,{subcategories:{},quantity:0,price_limit:0}]}}})))},children:t("ADD_CONDITION")}),(0,g.jsxs)("div",{className:"form-bottom-action mt-30",children:[(0,g.jsx)(r.zx,{variant:"ghost",onClick:()=>{var e;e=`${u}/${encodeURIComponent(b.id)}`,I?R(!0):o.push(e)},children:t("CANCEL")}),(0,g.jsx)(r.zx,{type:"submit",variant:"primary",disabled:d,children:t("UPDATE")})]})]}),(0,g.jsx)(r.RZ,{modal:T,setModal:R,onLeave:()=>o.push(`${u}/${encodeURIComponent(b.id)}`)})]})},$=()=>{const e=(0,r.h_)(n.pH.VOUCHER),s=(0,_.UO)(),[t,a]=(0,l.useState)(),[i,c]=(0,l.useState)(!0),{t:o}=(0,r.$G)();return(0,l.useEffect)((()=>{(async()=>{var t;const l=await e.get(`/programs/${s.id}`);a(null==l||null==(t=l.data)?void 0:t.result),c(!1)})()}),[s.id]),i?(0,g.jsxs)(r.rj,{gutter:0,children:[(0,g.jsx)(r.Od,{className:"ml-10",parts:["header"]}),(0,g.jsx)(r.Zb,{children:(0,g.jsx)(r.Od,{parts:["title","divider","text-2","labelField-1"]})})]}):(0,g.jsx)(r.rj,{gutter:0,children:(0,g.jsx)(r.X2,{children:(0,g.jsx)(r.Zb,{className:"network-content",page:!0,header:(0,g.jsx)("div",{children:(0,g.jsx)(r.ZT,{h2:!0,children:null==t?void 0:t.name})}),children:t&&(0,g.jsx)(r.X2,{children:(0,g.jsxs)(r.sg,{offset:3,size:6,children:[(0,g.jsxs)("div",{className:"ui-flex column mb-20",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"mb-10",children:o("VOUCHER_TYPE")}),(0,g.jsx)(r.ZT,{children:n.PJ[t.type]})]}),(e=>{switch(e){case n.$f.DISCOUNT:return(0,g.jsx)(G,{voucherProgram:t});case n.$f.PER_DIEM:return(0,g.jsx)(Z,{voucherProgram:t});case n.$f.PRE_FIXE:return(0,g.jsx)(w,{voucherProgram:t})}return(0,g.jsx)("div",{})})(s.type)]})})})})})};var F=t("KOB3"),z=t.n(F);const k=e=>(0,g.jsx)(r.rU,{component:r.zx,variant:"ghost",size:"medium",className:"voucher-dropdown-link mt-5",type:"file",onClick:()=>((s,t)=>{const l=z().unparse({data:s,fields:t}),a=new Blob([l],{type:"text/csv;charset=utf-8;"}),r=window.URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.setAttribute("download",e.fileName),n.click(),e.onClose()})(e.data,e.fields),children:e.label});var W=t("EfWb"),X=function(e,s,t){return void 0===s&&(s={}),void 0===t&&(t={}),function(l,a,r){try{return Promise.resolve(function(n,i){try{var c=(s.context,Promise.resolve(e["sync"===t.mode?"validateSync":"validate"](l,Object.assign({abortEarly:!1},s,{context:a}))).then((function(e){return r.shouldUseNativeValidation&&(0,W.M)({},r),{values:e,errors:{}}})))}catch(o){return i(o)}return c&&c.then?c.then(void 0,i):c}(0,(function(e){return{values:{},errors:(0,W.D)((s=e,t=!r.shouldUseNativeValidation&&"all"===r.criteriaMode,(s.inner||[]).reduce((function(e,s){if(e[s.path]||(e[s.path]={message:s.message,type:s.type}),t){var l=e[s.path].types,a=l&&l[s.type];e[s.path]=(0,O.KN)(s.path,t,e,s.type,a?[].concat(a,s.message):s.message)}return e}),{})),r)};var s,t})))}catch(n){return Promise.reject(n)}}};const Q=e=>{var s,t,a,i,c;const{t:o}=(0,r.$G)(),d=(0,r.h_)(n.pH.VOUCHER),[u,h]=(0,l.useState)(!1),[m,x]=(0,l.useState)(""),{user:j}=(0,l.useContext)(r.Il),E=null==j?void 0:j.details,p=null==E||null==(s=E.roles)?void 0:s.includes(n.HB.SUPER_ADMIN),v=null==E||null==(t=E.roles)?void 0:t.includes(n.HB.HOTEL_PARTNER),C=p?{defaultValues:{userEmail:null==(a=j.details)?void 0:a.email},resolver:X(n.En)}:{},{register:N,formState:{errors:b},handleSubmit:y}=(0,O.cI)(C),[T,R]=(0,l.useState)("");return(0,g.jsxs)(r.u_,{visible:!0,onClose:()=>e.meta.checkedState=[],style:{minWidth:360},children:[(0,g.jsx)("h3",{children:o("RESEND_VOUCHER_CODES")}),(0,g.jsx)(r.iz,{}),p&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(r.ZT,{span:!0,className:"my-10",children:o("ENTER_EMAIL")}),(0,g.jsx)(r.NI,{label:"",className:"ui-flex my-10",children:(0,g.jsx)(r.II,Object.assign({placeholder:o("EMAIL_TO"),className:"w-100"},N("userEmail"),{onChange:e=>{var s;return x(null==e||null==(s=e.target)?void 0:s.value)},type:"email",error:null==b||null==(i=b.userEmail)?void 0:i.message}))})]}),v&&(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:o("EMAIL")}),(0,g.jsx)(r.ZT,{children:null==j||null==(c=j.details)?void 0:c.email})]})}),(0,g.jsx)("form",{onSubmit:y((()=>{(async()=>{try{h(!0);const s=e.meta.checkedState.map((e=>e.id));await d.post("/codes/generate/pdf/vouchers",{input:{voucherCodeBulk:{voucherCodes:s,hotelId:e.meta.hotelId}},email:p?m:null==E?void 0:E.email})}catch(T){R(T.response.data.error)}finally{h(!1),e.onClose()}})()})),children:(0,g.jsxs)("div",{className:"ui-flex mt-20 end",children:[(0,g.jsx)(r.zx,{size:"large",variant:"ghost",onClick:()=>e.onClose(),children:o("CANCEL")}),(0,g.jsx)(r.zx,{disabled:u,size:"large",variant:"primary",style:{marginLeft:20},type:"submit",children:o("RESEND")})]})})]})},B=()=>{const{t:e}=(0,r.$G)(),s=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"ui-border-bottom pb-10 pt-10",children:[(0,g.jsx)("div",{className:"mb-10",children:(0,g.jsx)(r.ZT,{children:n.PJ.PRE_FIXE})}),(0,g.jsx)("div",{className:"mt-5",children:(0,g.jsx)(r.ZT,{p:!0,muted:!0,children:e("PRE_FIXE_DESCRIPTION")})})]}),(0,g.jsxs)("div",{className:"ui-border-bottom pb-10 pt-10",children:[(0,g.jsx)("div",{className:"mb-10",children:(0,g.jsx)(r.ZT,{children:n.PJ.DISCOUNT})}),(0,g.jsx)("div",{className:"mt-5",children:(0,g.jsx)(r.ZT,{p:!0,muted:!0,children:e("DISCOUNT_DESCRIPTION")})})]}),(0,g.jsxs)("div",{className:"pb-10 pt-10",children:[(0,g.jsx)("div",{className:"mb-10",children:(0,g.jsx)(r.ZT,{children:n.PJ.PER_DIEM})}),(0,g.jsx)("div",{className:"mt-5",children:(0,g.jsx)(r.ZT,{p:!0,muted:!0,children:e("PER_DIEM_DESCRIPTION")})})]})]});return(0,g.jsx)(r.u,{className:"voucher-type-tooltip",content:s,placement:"right",children:(0,g.jsx)(r.JO,{className:"ml-5",type:"Infoi",size:16})})},Y=()=>{var e,s,t,i,c;const{t:o}=(0,r.$G)(),{can:d}=(0,l.useContext)(r.Il),u=(0,r.h_)(n.pH.VOUCHER),h=(0,r.h_)(n.pH.NETWORK),m=(0,a.UO)(),x=(0,_.k6)(),[j,C]=(0,l.useState)(),[N,b]=(0,l.useState)(),[y,T]=(0,l.useState)(!0),[O,R]=(0,l.useState)(!1),[I,f]=(0,l.useState)(""),[S,A]=(0,l.useState)(""),[U,P]=(0,l.useState)(""),[D,V]=(0,l.useState)([]),[H,L]=(0,l.useState)([]),[M,G]=(0,l.useState)(!1),[Z,w]=(0,l.useState)(!1),[$,F]=(0,l.useState)(!1),[z,W]=(0,l.useState)(),[X,Y]=(0,l.useState)(new Date),J=`/codes/active/${m.hotelId}`,q=d&&d(p.g.VOUCHER.CAN_GET_HOTEL_VOUCHER_CODES),K=()=>{L([]),V([]),F(!1)},ee=()=>{const e=!Z;return w(e),e},se=null==j||null==(e=j.result)?void 0:e.filter((e=>D.includes(e))).map((e=>[e.program.name,e.code,e.created_at,e.program.type,e.status]));(0,l.useEffect)((()=>{(async()=>{await void(async()=>{try{const e=await u.get(J);C(e.data)}catch(e){R(!0)}finally{T(!1)}})(),await(async()=>{const e=await h.get(`/hotels/${m.hotelId}`);W(e.data)})(),T(!1)})()}),[]);const te=[{name:"program type",queryParamName:"program_types",data:async()=>[{label:n.PJ.DISCOUNT,queryParamValue:n.$f.DISCOUNT},{label:n.PJ.PER_DIEM,queryParamValue:n.$f.PER_DIEM},{label:n.PJ.PRE_FIXE,queryParamValue:n.$f.PRE_FIXE}]},{name:"status",queryParamName:"status",data:async()=>[{label:n.r2.PENDING,queryParamValue:n.r2.PENDING},{label:n.r2.REDEEMED,queryParamValue:n.r2.REDEEMED}]}];if((0,l.useEffect)((()=>{P(x.location.search);const e=E().parse(x.location.search.replace("?","").replace(/\|([^&]*)&?/g,"&"));e.search&&f(e.search)}),[x.location.search]),(0,r.N7)((()=>{(async()=>{const e=E().parse(x.location.search.replace("?","").replace(/\|([^&]*)&?/g,"&"));S&&(e.search=S);let s=decodeURIComponent(E().stringify(e)).replace(/\|([^&]*)&?/g,"&");const t=await u.get(`${J}?${s}`);C(t.data),T(!1)})(),F(!1),L([])}),[S,U,J,u]),(0,r.N7)((()=>{const e=setTimeout((()=>{const e=E().parse(x.location.search.replace("?","").replace(/\|([^&]*)&?/g,"&"));I?e.search=I:delete e.search;const s=E().stringify(e).replace(/\|([^&]*)&?/g,"&");x.push(`?${s}`)}),500);return()=>clearTimeout(e)}),[I]),!q||O)return(0,g.jsx)(v,{entity:"Hotel codes"});if(y)return(0,g.jsx)(r.rj,{gutter:0,children:(0,g.jsx)(r.Zb,{children:(0,g.jsx)(r.Od,{parts:["cardHeaderAction","divider","table"]})})});const le="20%";return(0,g.jsxs)(r.rj,{gutter:0,children:[(0,g.jsx)(r.X2,{children:(0,g.jsx)(r.sg,{children:(0,g.jsx)(r.Zb,{className:"voucher-content",page:!0,header:(0,g.jsx)(r.ZT,{h2:!0,children:o("HOTEL_INFORMATION")}),children:(0,g.jsx)(r.X2,{children:(0,g.jsxs)("div",{className:"ui-flex column",children:[(0,g.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:o("HOTEL_NAME")}),(0,g.jsx)(r.ZT,{children:null==z||null==(s=z.result)?void 0:s.name})]})})})})}),(0,g.jsxs)(r.X2,{children:[(0,g.jsx)(r.sg,{children:(0,g.jsxs)(r.Zb,{className:"voucher-content",page:!0,header:(0,g.jsx)(r.ZT,{h2:!0,children:o("VOUCHER_CODES")}),children:[(0,g.jsx)("div",{className:"voucher-toolbar",children:(0,g.jsxs)("div",{className:"voucher-toolbar-actions ui-flex start v-center",children:[(0,g.jsx)(r.x$,{columns:te,onChange:e=>{P(e),x.push(`?${e}`)},filtersString:U}),(0,g.jsx)(r.Vr,{value:I,placeholder:"Search...",onChange:e=>f(e.target.value)}),(0,g.jsx)(r.Mt,{range:!0})]})}),(0,g.jsxs)(r.iA,{children:[(0,g.jsx)(r.ss,{children:(0,g.jsxs)(r.SC,{children:[(0,g.jsx)(r.pj,{as:"th",style:{width:le},children:o("VOUCHER_NAME")}),(0,g.jsx)(r.pj,{as:"th",style:{width:le},children:o("CODE")}),(0,g.jsx)(r.pj,{as:"th",style:{width:le},children:o("DATE_CREATED")}),(0,g.jsxs)(r.pj,{as:"th",style:{width:le},children:[o("TYPE"),(0,g.jsx)(B,{})]}),(0,g.jsx)(r.pj,{as:"th",style:{width:le},children:o("STATUS")}),(0,g.jsx)(r.pj,{as:"th"}),(null==j?void 0:j.result)&&(null==j||null==(t=j.result)?void 0:t.length)>0&&(0,g.jsxs)(r.pj,{as:"th",className:H.length>0&&H.length!==(null==j||null==(i=j.result)?void 0:i.length)?"checkbox-corners-fill":"",style:{width:150},children:[(0,g.jsx)(r.XZ,{checked:$,onChange:e=>{var s;F(!$),$?K():(null==j||null==(s=j.result)||s.forEach((e=>!H.includes(e)&&H.push(e))),F(!0),V([...H]))}}),(0,g.jsx)(r.Lt,{renderTrigger:(e,s,t)=>(0,g.jsx)(r.Xd,{className:"ml-5",onClick:()=>H.length>0?e():"",ref:s,children:(0,g.jsx)(r.JO,{type:"ArrowDown",size:14})}),hasArrow:!0,placement:"right",children:(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:160},children:[(0,g.jsx)(r.zx,{variant:"ghost",disabled:M,onClick:()=>b({checkedState:D,hotelId:m.hotelId}),children:"Resend Selected"}),(0,g.jsx)(k,{label:"Export to CSV",data:se,fields:["Voucher Name","Code","Date Created","Type","Status"],fileName:"vouchers.csv",onClose:()=>{ee(),K()}})]})})]})]})}),(0,g.jsx)(r.RM,{children:null==j||null==(c=j.result)?void 0:c.map((e=>(0,g.jsxs)(r.SC,{onClick:()=>window.alert("haha"),children:[(0,g.jsx)(r.pj,{children:e.program.name}),(0,g.jsx)(r.pj,{children:e.code}),(0,g.jsx)(r.pj,{children:(null==e?void 0:e.created_at)&&new Date(e.created_at).toDateString()}),(0,g.jsx)(r.pj,{children:n.PJ[e.program.type]}),(0,g.jsx)(r.pj,{children:e.claimed_date?o("REDEEMED"):o("PENDING")}),(0,g.jsx)(r.pj,{children:e.claimed_date&&(0,g.jsx)(r.Kk,{size:"small",variant:"primary",children:(0,g.jsx)(r.JO,{type:"DocumentWithLines",size:20})})}),(0,g.jsx)(r.pj,{style:{width:150},children:(0,g.jsx)(r.XZ,{value:e.code,checked:H.includes(e),onChange:s=>{((e,s)=>{var t;e.checked&&!H.includes(s)?H.push(s):H.splice(H.indexOf(s),1),H.length===(null==j||null==(t=j.result)?void 0:t.length)?F(!0):F(!1),V([...H])})(s.target,e)}},e.id)})]},e.id)))})]}),(!(null!=j&&j.result)||0===(null==j?void 0:j.result.length))&&!y&&(0,g.jsx)(r.xM,{})]})}),N&&(0,g.jsx)(Q,{meta:N,onClose:()=>{ee(),K(),b(void 0)}})]})]})};var J=t("vB0K"),q=t.n(J),K=t("LOwH"),ee=t.n(K),se=t("H/Mb"),te=t.n(se),le=t("MtWZ"),ae=t.n(le),re=t("j8Os"),ne=t.n(re),ie=t("i/5k"),ce=t.n(ie),oe=t("r05z"),de=t.n(oe),ue={};ue.styleTagTransform=ce(),ue.setAttributes=ae(),ue.insert=te().bind(null,"head"),ue.domAPI=ee(),ue.insertStyleElement=ne();q()(de(),ue);de()&&de().locals&&de().locals;const he={en:{translation:{HOTELS_LIST:"Hotels List",HOTEL_NAME:"Hotel Name",PROGRAM_TYPES:"Program Types",NUMBER_OF_PROGRAMS:"Number of Programs",NUMBER_OF_CODES:"Number of Codes",PROGRAMS:"Programs",CODES:"Codes",CREATE_NEW:"Create New",HOTEL_INFORMATION:"Hotel Information",VOUCHER_PROGRAMS:"Voucher Programs",NAME:"Name",TYPE:"Type",STATUS:"Status",PDF:"PDF",GENERATE_CODES:"Generate Codes",MANAGE:"Manage",DELETE:"Delete",ACTIVATE:"Activate",DEACTIVATE:"Deactivate",ACTIVATE_PROGRAM:"Activate Program",DEACTIVATE_PROGRAM:"Deactivate Program",ACTIVE:"Active",INACTIVE:"Inactive",DELETE_VOUCHER_PROGRAM:"Delete Voucher Program?",CONFIRM_DELETE_VOUCHER:"Are you sure you want to delete this voucher program?",ACTIVATE_VOUCHER:"Activate Voucher",CONFIRM_ACTIVATE_PROGRAM:"Are you sure you want to activate this program?",DEACTIVATE_VOUCHER:"Deactivate Voucher",CONFIRM_DEACTIVATE_PROGRAM:"Are you sure you want to deactivate this program?",GENERATE_VOUCHER_CODES:"Generate Voucher Codes",NUMBER_OF_CODES_PLACEHOLDER:"Enter the number of codes to generate",EMAIL:"Email",EMAIL_TO:"Enter the email to send codes to",GENERATE:"Generate",GENERATING_ELLIPSIS:"Generating...",CANCEL:"Cancel",VOUCHER_PROGRAM:"Voucher Program",ENTER_VOUCHER_PROGRAM_NAME:"Enter voucher program name",HOTEL:"Hotel",PAYER:"Payer",PAYER_PERCENTAGE:"Payer Percentage",NOTES:"Notes",NOTES_FOR_HOTEL:"Notes for Hotel",CODE_LIMIT_PER_DAY:"Code limit per day",CODE_LIMIT:"Code limit",VOUCHER_TYPE:"Voucher Type",SELECT_VOUCHER_TYPE:"Select voucher type",VOUCHER_ITEMS:"Voucher Items",VOUCHER_DISCOUNT:"Voucher Discount",PAYMENT:"Payment",PAYMENT_TYPE:"Payment Type",AMOUNT_USD:"Amount ($)",SELECT_CATEGORY:"Select a Category",PRICE:"Price",QUANTITY:"Quantity",PRICE_LIMIT:"Price limit",CATEGORIES:"Categories",ADD_CONDITION:"Add Condition",SAVE:"Save",CREATE:"Create",EDIT:"Edit",UPDATE:"Update",HOTEL_CODE:"Hotel Code",CONFIGS:"Configs",VOUCHER_CODES:"Voucher Codes",VOUCHER_NAME:"Voucher Name",CODE:"Code",DATE_CREATED:"Date Created",SELECT_ALL:"Select All",DESELECT_VISIBLE:"Deselect Visible",SELECT_VISIBLE:"Select Visible",PENDING:"PENDING",REDEEMED:"REDEEMED",RESEND:"Resend",CREATE_VOUCHER:"Create Voucher",SELECT_HOTEL:"Select a hotel",DISCOUNT:"Discount",PRE_FIXE:"Pre Fixe",PER_DIEM:"Per Diem",VOUCHER_DETAILS:"Voucher Details",AMOUNT:"Amount",CATEGORY:"Category",SUBCATEGORIES:"Subcategories","Hotel code":"Hotel Code","Hotel name":"Hotel Name",ENTER_DISCOUNT:"Enter Discount",ENTER_AMOUNT:"Enter an amount",MEAL_PERIOD:"Meal Period",SELECT_MEAL_PERIOD:"Select Meal Period",HOTELS:"Hotels",RESEND_VOUCHER_CODES:"Resend Voucher Codes",PRE_FIXE_DESCRIPTION:"Meal vouchers that include options from select menu categories(one-time use)",DISCOUNT_DESCRIPTION:"Discounts that are applied as either a dollar amount or percentage off of order total (one-time use)",PER_DIEM_DESCRIPTION:"Dollar stipend applied by day","ui_sdk.smart_component.leave_page_alert":"Hey there! It looks like you\u2019re in the middle of writing something and you\n      haven\u2019t saved all of your content.",table:{data:{no_data:"No Data",no_data_found:"No data found"}},"":""}}};(0,r.Dm)(he);const me=({history:e})=>{const{t:s}=(0,r.$G)(),{setNavigation:t,can:j,user:E}=(0,l.useContext)(r.Il),v=null==E?void 0:E.details,N=null==v?void 0:v.roles,b=null==N?void 0:N.includes(n.HB.SUPER_ADMIN),y=null==N?void 0:N.includes(n.HB.HOTEL_PARTNER),T=j&&j(p.g.VOUCHER.CAN_GET_HOTELS_WITH_VOUCHERS),O=j&&j(p.g.VOUCHER.CAN_LIST_VOUCHER_PROGRAMS),R=j&&j(p.g.VOUCHER.CAN_GET_HOTEL_VOUCHER_CODES),_=b?x.path:`${m}/${v.hotel_id}`;return(0,l.useEffect)((()=>{let e=[];b?e=[{name:s("HOTELS"),path:x.path,permission:T}]:y&&(e=[{name:s("PROGRAMS"),path:`${c}/${null==v?void 0:v.hotel_id}`,permission:O},{name:s("CODES"),path:`${m}/${null==v?void 0:v.hotel_id}`,permission:R}]),t&&t(n.pH.VOUCHER,e)}),[T,O,R]),(0,g.jsx)(a.F0,{history:e,children:(0,g.jsxs)(a.rs,{children:[(0,g.jsx)(a.AW,{exact:!0,path:"/voucher",children:(0,g.jsx)(a.l_,{to:_})}),(0,g.jsx)(a.AW,{exact:!0,path:i.path,children:(0,g.jsx)(C,{})}),(0,g.jsx)(a.AW,{exact:!0,path:x.path,children:(0,g.jsx)(C,{})}),(0,g.jsx)(a.AW,{exact:!0,path:`${c}/:hotelId`,children:(0,g.jsx)(I,{})}),(0,g.jsx)(a.AW,{exact:!0,path:`${u}/:id`,children:(0,g.jsx)(A,{})}),(0,g.jsx)(a.AW,{exact:!0,path:`${h.path}`,children:(0,g.jsx)(L,{})}),(0,g.jsx)(a.AW,{exact:!0,path:`${o}/:id`,children:(0,g.jsx)(M,{})}),(0,g.jsx)(a.AW,{exact:!0,path:`${d}/:type/:id`,children:(0,g.jsx)($,{})}),(0,g.jsx)(a.AW,{exact:!0,path:`${m}/:hotelId`,children:(0,g.jsx)(Y,{})})]})})}},r05z:e=>{e.exports=[[e.id,".network-container{display:flex;flex-direction:column;height:100%;width:100%}.network-container .network-content+.network-content{margin-top:10px}.network-content{width:100%;flex:1}.network-content>.butler-row{margin-top:0}.toolbar{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:20px 30px}.butler-row+.butler-row{margin-top:0}.form-bottom-action{display:flex;flex-direction:row;align-items:center;justify-content:flex-end}.form-bottom-action>.ui-btn+.ui-btn{margin-left:10px}.network-sidebar-wrapper .ui-btn+.ui-btn{margin-top:10px}.network-sidebar-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:15px}.voucher-toolbar{display:flex;align-items:center;justify-content:space-between;margin:20px 0}.voucher-dropdown-link{text-decoration:none}.voucher-type-tooltip .ui-tooltip{height:100%}.checkbox-corners-fill .ui-checkbox{border:2px solid var(--theme-primary, #004438)}.checkbox-corners-fill .ui-checkbox-wrapper:hover .ui-checkbox{border:2px solid var(--theme-primary, #004438)}.menu-no-permissions{flex:1}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0eWxlcy5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLG1CQUFtQixZQUFZLENBQUMscUJBQXFCLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxxREFBcUQsZUFBZSxDQUFDLGlCQUFpQixVQUFVLENBQUMsTUFBTSxDQUFDLDZCQUE2QixZQUFZLENBQUMsU0FBUyxZQUFZLENBQUMsa0JBQWtCLENBQUMsa0JBQWtCLENBQUMsNkJBQTZCLENBQUMsaUJBQWlCLENBQUMsd0JBQXdCLFlBQVksQ0FBQyxvQkFBb0IsWUFBWSxDQUFDLGtCQUFrQixDQUFDLGtCQUFrQixDQUFDLHdCQUF3QixDQUFDLG9DQUFvQyxnQkFBZ0IsQ0FBQyx5Q0FBeUMsZUFBZSxDQUFDLHdCQUF3QixZQUFZLENBQUMsa0JBQWtCLENBQUMsNkJBQTZCLENBQUMsa0JBQWtCLENBQUMsaUJBQWlCLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyw2QkFBNkIsQ0FBQyxhQUFhLENBQUMsdUJBQXVCLG9CQUFvQixDQUFDLGtDQUFrQyxXQUFXLENBQUMsb0NBQW9DLDhDQUE4QyxDQUFDLCtEQUErRCw4Q0FBOEMsQ0FBQyxxQkFBcUIsTUFBTSIsImZpbGUiOiJzdHlsZXMuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5uZXR3b3JrLWNvbnRhaW5lcntkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2hlaWdodDoxMDAlO3dpZHRoOjEwMCV9Lm5ldHdvcmstY29udGFpbmVyIC5uZXR3b3JrLWNvbnRlbnQrLm5ldHdvcmstY29udGVudHttYXJnaW4tdG9wOjEwcHh9Lm5ldHdvcmstY29udGVudHt3aWR0aDoxMDAlO2ZsZXg6MX0ubmV0d29yay1jb250ZW50Pi5idXRsZXItcm93e21hcmdpbi10b3A6MH0udG9vbGJhcntkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246cm93O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjtwYWRkaW5nOjIwcHggMzBweH0uYnV0bGVyLXJvdysuYnV0bGVyLXJvd3ttYXJnaW4tdG9wOjB9LmZvcm0tYm90dG9tLWFjdGlvbntkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246cm93O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmR9LmZvcm0tYm90dG9tLWFjdGlvbj4udWktYnRuKy51aS1idG57bWFyZ2luLWxlZnQ6MTBweH0ubmV0d29yay1zaWRlYmFyLXdyYXBwZXIgLnVpLWJ0bisudWktYnRue21hcmdpbi10b3A6MTBweH0ubmV0d29yay1zaWRlYmFyLWhlYWRlcntkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO21hcmdpbi1ib3R0b206MTVweH0udm91Y2hlci10b29sYmFye2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47bWFyZ2luOjIwcHggMH0udm91Y2hlci1kcm9wZG93bi1saW5re3RleHQtZGVjb3JhdGlvbjpub25lfS52b3VjaGVyLXR5cGUtdG9vbHRpcCAudWktdG9vbHRpcHtoZWlnaHQ6MTAwJX0uY2hlY2tib3gtY29ybmVycy1maWxsIC51aS1jaGVja2JveHtib3JkZXI6MnB4IHNvbGlkIHZhcigtLXRoZW1lLXByaW1hcnksICMwMDQ0MzgpfS5jaGVja2JveC1jb3JuZXJzLWZpbGwgLnVpLWNoZWNrYm94LXdyYXBwZXI6aG92ZXIgLnVpLWNoZWNrYm94e2JvcmRlcjoycHggc29saWQgdmFyKC0tdGhlbWUtcHJpbWFyeSwgIzAwNDQzOCl9Lm1lbnUtbm8tcGVybWlzc2lvbnN7ZmxleDoxfSJdfQ== */","",""]]}}]);