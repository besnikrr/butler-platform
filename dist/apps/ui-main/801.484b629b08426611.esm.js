(self.webpackChunk=self.webpackChunk||[]).push([[801],{aqfT:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>G});var l=a("ERkP"),i=a("daAW"),r=a("BhJM"),t=a("MNxq"),n=a("jg1C");const c=()=>{const{can:e}=(0,l.useContext)(r.Il),{t:s}=(0,r.$G)(),a=e&&e("permission::iam::CAN_CREATE_USER"),i=e&&e("permission::iam::CAN_LIST_USERS");return(0,n.jsx)(r.rj,{gutter:0,children:(0,n.jsx)(r.lL,{title:s("User List"),app:t.pH.IAM,label:"user",path:"users",createButtonVisible:a,itemListVisible:i,onDeleteMsg:s("User deleted successfully"),columns:[{key:"display_name",header:s("Full Name"),link:!0},{key:"email",header:s("Email")}],createNewPath:"/iam/users/create",detailsPath:e=>`/iam/users/details/${e.id}`})})};var d=a("geiN");const h="/iam",o="/iam/users",p="/iam/roles",m=()=>{var e,s;const a=(0,r.h_)(t.pH.IAM),c=(0,i.k6)(),h=(0,i.UO)(),[o,p]=(0,l.useState)(),[m,x]=(0,l.useState)(),[u,j]=(0,l.useState)(!0);(0,l.useEffect)((()=>{(async()=>{const e=await a.get(`/users/${h.id}`),s=null==e?void 0:e.data.result,l=(await a.get("/roles")).data.result;x(s),p(l),N({display_name:s.display_name,email:s.email,roles:s.roles}),j(!1)})()}),[h.id]);const{register:v,handleSubmit:b,formState:{errors:k},watch:g,control:f,reset:N}=(0,d.cI)({defaultValues:{}}),[y,S]=(0,l.useState)(!1),[Z,C]=(0,l.useState)();return u?(0,n.jsxs)(r.rj,{gutter:0,children:[(0,n.jsx)(r.Od,{className:"ml-10",parts:["header"]}),(0,n.jsxs)(r.Zb,{children:[(0,n.jsx)(r.Od,{parts:["title"]}),(0,n.jsx)(r.Od,{parts:["title"]}),(0,n.jsx)(r.Od,{parts:["title"]})]})]}):(0,n.jsx)(r.rj,{gutter:0,children:(0,n.jsx)(r.X2,{children:(0,n.jsx)(r.sg,{children:(0,n.jsx)(r.Zb,{className:"network-content",page:!0,header:(0,n.jsx)("div",{children:(0,n.jsx)(r.ZT,{h2:!0,children:"Edit user"})}),children:(0,n.jsxs)(r.X2,{children:[(0,n.jsx)(r.sg,{offset:3,size:6,children:(0,n.jsxs)("form",{onSubmit:b((async e=>{C(void 0),console.log("data: ",e);try{S(!0),await a.patch(`/users/${h.id}`,e),c.push("/iam/users/list")}catch(Z){C(Z.response.data.error)}finally{S(!1)}})),children:[(0,n.jsx)(r.NI,{label:"Display name",children:(0,n.jsx)(r.II,Object.assign({placeholder:"display name"},v("display_name"),{error:null==k||null==(e=k.display_name)?void 0:e.message}))}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{label:"Email",children:(0,n.jsx)(r.II,Object.assign({placeholder:"email"},v("email"),{error:null==k||null==(s=k.email)?void 0:s.message}))}),(0,n.jsx)("br",{}),(0,n.jsx)(r.iz,{}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{children:o&&o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.ZT,{h2:!0,children:"Roles"}),(0,n.jsx)("br",{}),(0,n.jsxs)(r.iA,{children:[(0,n.jsx)(r.ss,{children:(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{as:"th",style:{width:50}}),(0,n.jsx)(r.pj,{as:"th",children:"Role"})]})}),(0,n.jsx)(r.RM,{children:null==o?void 0:o.map(((e,s)=>(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{className:"act",children:(0,n.jsx)(r.XZ,Object.assign({value:e.id},v("roles")),e.id)}),(0,n.jsx)(r.pj,{children:e.name})]},`item-${s}`)))})]})]})}),(0,n.jsx)(r.iz,{vertical:30}),(0,n.jsx)(r.X2,{children:(0,n.jsxs)("div",{className:"form-bottom-action",children:[(0,n.jsx)(r.zx,{variant:"ghost",onClick:()=>{c.push("/iam/users")},children:"Cancel"}),(0,n.jsx)(r.zx,{type:"submit",variant:"primary",disabled:y,children:"Create"})]})})]})}),Z&&(0,n.jsx)("span",{children:Z})]})})})})})};var x=a("KDUK");const u=({user:e,roles:s})=>{const{t:a}=(0,r.$G)(),{can:i,tenant:c}=(0,l.useContext)(r.Il),d=(0,x.k6)(),h=(0,r.h_)(t.pH.IAM),{deleteResourceMeta:o,setDeleteResourceMeta:p}=(0,r.IJ)(),[m,u]=(0,l.useState)(!1),[j,v]=(0,l.useState)(!0),b=i&&i("permission::iam::CAN_DELETE_USER"),k=i&&i("permission::iam::CAN_PATCH_USER");(0,l.useEffect)((()=>{u(!1)}),[o]);return(0,n.jsx)(r.X2,{children:(0,n.jsx)(r.sg,{children:(0,n.jsxs)(r.Zb,{className:"network-content",page:!0,header:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.ZT,{h2:!0,children:a("General Information")}),(0,n.jsx)(r.Lt,{renderTrigger:(e,s,a)=>(0,n.jsx)(r.Kk,{ref:s,onClick:e,children:(0,n.jsx)(r.JO,{type:"ThreeDots",size:40})}),hasArrow:!0,placement:"right",children:(0,n.jsx)("div",{className:"ui-flex column network-action-dropdown",children:(0,n.jsxs)("div",{children:[k&&(0,n.jsxs)(r.zx,{className:"w-100",variant:"ghost",muted:!0,onClick:()=>{d.push(`/iam/users/edit/${null==e?void 0:e.id}`)},children:[(0,n.jsx)(r.JO,{type:"Pen01",size:20,className:"mr-10"}),a("Manage")]}),k&&(0,n.jsxs)(r.zx,{className:"w-100",variant:"ghost",muted:!0,onClick:()=>{(async()=>{v(!0),(await h.post("/users/init/reset/password",{clientId:c.cognito.clientId,email:null==e?void 0:e.email})).data&&(v(!1),(0,r.hi)(a(`Password reset request sent to ${null==e?void 0:e.email}`),{type:"success"}))})()},children:[(0,n.jsx)(r.JO,{type:"Pen02",size:20,className:"mr-10"}),a("Reset password")]}),b&&(0,n.jsxs)(r.zx,{className:"w-100",variant:"danger-ghost",muted:!0,onClick:()=>{null!=e&&e.id&&p({label:"user",resource:"users",id:null==e?void 0:e.id})},children:[(0,n.jsx)(r.JO,{type:"Delete",size:20,className:"mr-10"}),a("Delete")]})]})})}),o&&(0,n.jsx)(r.QG,{meta:o,onClose:()=>{p(void 0)},onDelete:()=>{p(void 0),(0,r.hi)("User deleted successfully",{type:"success"}),d.push("/iam/users/list")},api:h}),m&&(0,n.jsx)(r.u_,{visible:m,onClose:()=>{u(!1)},style:{width:360},children:(0,n.jsxs)("div",{children:[(0,n.jsx)(r.ZT,{h2:!0,className:"ui-link-danger",children:a("Error")}),(0,n.jsx)(r.iz,{}),(0,n.jsx)(r.ZT,{size:"large",children:a("Delete associated user")}),(0,n.jsx)("div",{className:"ui-flex end mt-30",children:(0,n.jsx)(r.zx,{size:"large",variant:"ghost",onClick:()=>{u(!1)},children:a("Cancel")})})]})})]}),children:[(0,n.jsx)(r.X2,{children:(0,n.jsxs)("div",{className:"ui-flex column",children:[(0,n.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("Full Name")}),(0,n.jsx)(r.ZT,{children:null==e?void 0:e.display_name})]})}),(0,n.jsx)(r.X2,{children:(0,n.jsxs)("div",{className:"ui-flex column",children:[(0,n.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("Email")}),(0,n.jsx)(r.ZT,{children:null==e?void 0:e.email})]})}),s&&s.length>0&&(0,n.jsx)(r.X2,{children:(0,n.jsxs)("div",{className:"ui-flex column",children:[(0,n.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("Roles")}),s.map((e=>(0,n.jsx)(r.ZT,{children:e.name},e.id)))]})})]})})})},j=()=>{const e=(0,r.h_)(t.pH.IAM),s=(0,x.UO)(),[a,i]=(0,l.useState)(!0),[c,d]=(0,l.useState)(),[h,o]=(0,l.useState)(),[p,m]=(0,l.useState)();(0,l.useEffect)((()=>{(async()=>{const a=await e.get(`/users/${s.id}`);d(null==a?void 0:a.data.result)})(),(async()=>{const s=await e.get("/roles");o(null==s?void 0:s.data.result)})()}),[e,s.id]),(0,l.useEffect)((()=>{c&&h&&j(c,h)}),[c,h]);const j=(e,s)=>{const a=[];e&&s&&s.length>0&&s.forEach((s=>{e.roles.includes(s.id)&&a.push(s)})),m(a),i(!1)};return a?(0,n.jsxs)(r.rj,{gutter:0,children:[(0,n.jsx)(r.Od,{className:"ml-10",parts:["header"]}),(0,n.jsxs)(r.Zb,{children:[(0,n.jsx)(r.Od,{parts:["title"]}),(0,n.jsx)(r.Od,{parts:["title"]}),(0,n.jsx)(r.Od,{parts:["title"]})]})]}):(0,n.jsx)(r.rj,{gutter:0,children:c&&p&&(0,n.jsx)(u,{user:c,roles:p})})};var v=a("61cJ");const b=()=>{var e,s,a;const{t:c}=(0,r.$G)(),h=(0,r.h_)(t.pH.IAM),o=(0,i.k6)(),[p,m]=(0,l.useState)(),[x,u]=(0,l.useState)();(0,l.useEffect)((()=>{(async()=>{const e=await h.get("/roles");u(e.data)})()}),[]);const{register:j,handleSubmit:b,formState:{errors:k},setValue:g,control:f}=(0,d.cI)({resolver:(0,v.X)(t.hB),defaultValues:{}}),[N,y]=(0,l.useState)(!1),[S,Z]=(0,l.useState)();console.log({errors:k});return(0,n.jsx)(r.rj,{gutter:0,children:(0,n.jsx)(r.X2,{children:(0,n.jsx)(r.sg,{children:(0,n.jsx)(r.Zb,{className:"network-content",page:!0,header:(0,n.jsx)("div",{children:(0,n.jsx)(r.ZT,{h2:!0,children:"Create user"})}),children:(0,n.jsxs)(r.X2,{children:[(0,n.jsx)(r.sg,{offset:3,size:6,children:(0,n.jsxs)("form",{onSubmit:b((async e=>{Z(void 0),e.roles=null==e?void 0:e.roles.filter((e=>"false"!==e));try{var s;y(!0);let a=await h.post("/users",e);o.push("/iam/users/list"),null!=a&&null!=(s=a.data)&&s.error?(0,r.hi)(c("User create failed"),{type:"error"}):(0,r.hi)(c("User created successfully"),{type:"success"})}catch(S){Z(S.response.data.error),(0,r.hi)(c("User create failed"),{type:"error"})}finally{y(!1)}})),children:[(0,n.jsx)(r.X2,{children:(0,n.jsx)(r.ZT,{h2:!0,children:"General Information"})}),(0,n.jsx)(r.iz,{}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{label:"Display name",children:(0,n.jsx)(r.II,Object.assign({placeholder:"display name"},j("display_name"),{error:null==k||null==(e=k.display_name)?void 0:e.message}))}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{label:"Email",children:(0,n.jsx)(r.II,Object.assign({placeholder:"Email"},j("email"),{error:null==k||null==(s=k.email)?void 0:s.message}))}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{label:"Phone number",children:(0,n.jsx)(r.II,{placeholder:"+138344212334",error:null==k||null==(a=k.phone_number)?void 0:a.message})}),(0,n.jsx)(r.iz,{}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{children:x&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.ZT,{h2:!0,children:"Roles"}),(0,n.jsx)("br",{}),(0,n.jsxs)(r.iA,{children:[(0,n.jsx)(r.ss,{children:(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{as:"th",style:{width:50}}),(0,n.jsx)(r.pj,{as:"th",children:"Role"})]})}),(0,n.jsx)(r.RM,{children:null==x||null==(C=x.result)?void 0:C.map(((e,s)=>(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{className:"act",children:(0,n.jsx)(r.XZ,Object.assign({},j(`roles.${s}`),{value:e.id}),e.id)}),(0,n.jsx)(r.pj,{children:e.name})]},`item-${s}`)))})]})]})}),(0,n.jsx)(r.iz,{vertical:30}),(0,n.jsx)(r.X2,{children:(0,n.jsxs)("div",{className:"form-bottom-action",children:[(0,n.jsx)(r.zx,{variant:"ghost",onClick:()=>{o.push("/iam/users")},children:"Cancel"}),(0,n.jsx)(r.zx,{type:"submit",variant:"primary",disabled:N,children:"Create"})]})})]})}),S&&(0,n.jsx)("span",{children:S})]})})})})});var C},k=()=>{const{can:e}=(0,l.useContext)(r.Il),{t:s}=(0,r.$G)(),a=(0,r.h_)(t.pH.IAM),i=e&&e("permission::iam::CAN_CREATE_ROLE"),c=e&&e("permission::iam::CAN_LIST_ROLES"),[d,h]=((0,x.k6)(),(0,l.useState)()),[o,p]=(0,l.useState)();return(0,l.useEffect)((()=>{(async()=>{const e=await a.get("/roles");p(e.data)})()}),[]),(0,n.jsx)(r.rj,{gutter:0,children:(0,n.jsx)(r.lL,{title:s("Role List"),app:t.pH.IAM,label:"role",path:"roles",createButtonVisible:i,itemListVisible:c,onDeleteMsg:s("Role deleted successfully"),columns:[{key:"name",header:s("Name")},{key:"description",header:s("Description")}],createNewPath:"/iam/roles/create",detailsPath:e=>`/iam/roles/details/${e.id}`})})},g=()=>{var e,s;const a=(0,r.h_)(t.pH.IAM),c=(0,i.k6)(),h=(0,i.UO)(),[o,p]=(0,l.useState)([]),[m,x]=(0,l.useState)(!0),[u,j]=(0,l.useState)(),[v,b]=(0,l.useState)([]),[k,g]=(0,l.useState)([]),[f,N]=(0,l.useState)([]),[y,S]=(0,l.useState)(""),[Z,C]=(0,l.useState)(""),[E,w]=(0,l.useState)(),[I,O]=(0,l.useState)(""),{handleSubmit:J,formState:{errors:Q}}=(0,d.cI)({defaultValues:{}}),[z,U]=(0,l.useState)(!1),[T,W]=(0,l.useState)();(0,r.N7)((()=>{const e=setTimeout((()=>{w(I)}),500);return()=>clearTimeout(e)}),[I]),(0,r.N7)((()=>{""!==E&&(async()=>{if(E){let e=await X(E.split("::")[0],E.split("::")[1]);(null==e?void 0:e.length)>0?G(E.split("::")[0],e):M(E.split("::")[0])}})()}),[E]),(0,l.useEffect)((()=>{x(!0);(async()=>{const e=(await a.get("/apps")).data.result||[];p(e)})(),x(!1)}),[]),(0,l.useEffect)((()=>{x(!0);(async()=>{var e,s,l,i,r,t;const n=await a.get(`/roles/${h.id}`);S(null==n||null==(e=n.data)||null==(s=e.result)?void 0:s.name),C(null==n||null==(l=n.data)||null==(i=l.result)?void 0:i.description);const c=null==n||null==(r=n.data)||null==(t=r.result)?void 0:t.permissions;b(c)})(),x(!1)}),[]),(0,l.useEffect)((()=>{x(!0);(async()=>{let e=[],s=o.map((e=>null==e?void 0:e.sk));if(s&&s.length>0){var l,i;const r=await a.get(`/permissions?app=${s}`);null==r||null==(l=r.data)||null==(i=l.result)||i.map((s=>{e.push(s.sk)}))}g(e)})(),x(!1)}),[o]),(0,l.useEffect)((()=>{x(!0);let e=((e,s)=>{let a=[];return e&&e.length>0&&e.filter((e=>{s.includes(e)||a.push(e)})),a})(k,v);N(e),x(!1)}),[k,v]),(0,l.useEffect)((()=>{x(!0);let e=o.map((e=>{let s=[];v.forEach((a=>{a&&a.split("::").includes(null==e?void 0:e.sk.split("::")[1])&&s.push({name:a,checked:!0,searched:!1})}));let a=[];return f.forEach((s=>{s&&s.split("::").includes(null==e?void 0:e.sk.split("::")[1])&&a.push({name:s,checked:!1,searched:!1})})),x(!1),{allChecked:!((null==a?void 0:a.length)>0),app:{name:e.name,description:e.description,checked:0!==s.length,pk:null==e?void 0:e.pk,sk:null==e?void 0:e.sk},permissions:[...s,...a],activeSearch:!1}}));j(e)}),[v,f]);const L=async(e,s,a)=>{let l=JSON.parse(JSON.stringify(u));l.forEach((l=>{var i;(null==(i=l.app)?void 0:i.sk)===e&&l.permissions&&l.permissions.forEach((e=>{(null==e?void 0:e.name)===s&&(e.checked=a)}))})),j(l)},A=(e,s)=>{let a=!0;return s&&s.forEach((s=>{s.app.sk===e&&s&&s.permissions&&s.permissions.forEach((e=>{e.checked||(a=!1)}))})),a},F=(e,s)=>{let a=!0;return s&&s.forEach((s=>{s.app.sk===e&&s&&s.permissions&&s.permissions.forEach((e=>{e.checked||(a=!1)}))})),a},X=async(e,s)=>{var l;let i=await a.get(`/permissions/search?app=${e}&permission=${s}`),r=[];return i&&(null==(l=i.data.result)||l.map((e=>{r.push(e.sk)}))),r},G=async(e,s)=>{let a=JSON.parse(JSON.stringify(u));a.forEach((a=>{var l;(null==(l=a.app)?void 0:l.sk)===`app::${e}`&&(a.activeSearch=!1,a.permissions&&a.permissions.forEach((e=>{e.searched=!1,s.includes(null==e?void 0:e.name)&&(e.searched=!0,a.activeSearch=!0)})))})),j(a)},M=async e=>{let s=JSON.parse(JSON.stringify(u));s.forEach((s=>{var a;(null==(a=s.app)?void 0:a.sk)===`app::${e}`&&(s.permissions&&s.permissions.forEach((e=>{e.searched=!1})),s.activeSearch=!1)})),j(s)};return m?(0,n.jsxs)(r.rj,{gutter:0,children:[(0,n.jsx)(r.Od,{className:"ml-10",parts:["header"]}),(0,n.jsxs)(r.Zb,{children:[(0,n.jsx)(r.Od,{parts:["title"]}),(0,n.jsx)(r.Od,{parts:["title"]}),(0,n.jsx)(r.Od,{parts:["title"]})]})]}):(0,n.jsx)(r.rj,{gutter:0,children:(0,n.jsx)(r.X2,{children:(0,n.jsx)(r.sg,{children:(0,n.jsx)(r.Zb,{className:"network-content",page:!0,header:(0,n.jsx)("div",{children:(0,n.jsx)(r.ZT,{h2:!0,children:"Edit role"})}),children:(0,n.jsxs)(r.X2,{children:[(0,n.jsx)(r.sg,{offset:3,size:6,children:(0,n.jsxs)("form",{onSubmit:J((async()=>{try{let e=[];u&&u.forEach((s=>{s.permissions&&s.permissions.forEach((s=>{s&&s.checked&&e.push(null==s?void 0:s.name)}))})),await a.patch(`/roles/${h.id}`,{name:y,description:Z,permissions:e}),c.push("/iam/roles/list")}catch(T){W(T.response.data.error)}finally{U(!1)}})),children:[(0,n.jsx)(r.NI,{label:"Name",children:(0,n.jsx)(r.II,{value:y,error:null==Q||null==(e=Q.email)?void 0:e.message,onChange:e=>{S(e.target.value)}})}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{label:"Description",children:(0,n.jsx)(r.II,{value:Z,error:null==Q||null==(s=Q.display_name)?void 0:s.message,onChange:e=>{C(e.target.value)}})}),(0,n.jsx)("br",{}),(0,n.jsx)(r.iz,{}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{children:u&&u&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.ZT,{h2:!0,children:"Apps"}),(0,n.jsx)("br",{}),(0,n.jsxs)(r.iA,{children:[(0,n.jsx)(r.ss,{children:(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{as:"th",style:{width:50}}),(0,n.jsx)(r.pj,{as:"th",children:"App"})]})}),(0,n.jsx)(r.RM,{children:null==u?void 0:u.map(((e,s)=>(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{className:"act",children:(0,n.jsx)(r.XZ,{value:e.app.sk,checked:e.app.checked,onChange:s=>(async(e,s)=>{let a=JSON.parse(JSON.stringify(u));a.forEach((a=>{var l;(null==(l=a.app)?void 0:l.sk)===e&&(a.app.checked=s,s||a.permissions&&a.permissions.forEach((e=>{e.checked=s})))})),j(a)})(e.app.sk,s.currentTarget.checked)},s)}),(0,n.jsx)(r.pj,{children:e.app.sk.split("::")[1].charAt(0).toUpperCase()+e.app.sk.split("::")[1].slice(1)})]},`item-${s}`)))})]})]})}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{children:u&&u&&u.map((e=>{var s;return e&&e.app.checked&&(null==(s=e.permissions)?void 0:s.length)>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.zF,{title:e.app.sk.split("::")[1].charAt(0).toUpperCase()+e.app.sk.split("::")[1].slice(1),open:!0,children:[(0,n.jsx)(r.ZT,{p:!0,muted:!0,className:"p-20",children:"Added Privileges"}),(0,n.jsx)("div",{className:"network-toolbar v-center mb-20",children:(0,n.jsx)("div",{className:"mr-20",children:(0,n.jsxs)("div",{className:"pl-20 ui-filter-wrapper",children:[e&&e.permissions.map((s=>s&&s.checked?(0,n.jsx)(r.Af,{className:"mb-10",onClose:()=>L(e.app.sk,s.name,!1),children:s.name.split("::")[2]},s.name):null)),(0,n.jsx)(r.X2,{children:(0,n.jsx)(r.II,{placeholder:"Search...",className:"mb-10",onChange:s=>O(e.app.sk.split("::")[1]+"::"+s.target.value.toUpperCase())})}),(0,n.jsxs)(r.iA,{children:[(0,n.jsx)(r.ss,{children:(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{children:"Name"}),(0,n.jsx)(r.pj,{style:{width:50},children:(0,n.jsx)(r.XZ,{value:e.app.name,checked:F(e.app.sk,u),onChange:s=>(async(e,s)=>{let a=JSON.parse(JSON.stringify(u));a.forEach((l=>{l&&l.app.sk===e&&(l.app.checked=s,l.permissions&&l.permissions.forEach((e=>{e.checked=s})),l.allChecked=A(e,a))})),j(a)})(e.app.sk,s.currentTarget.checked)},e.app.name)})]})}),(0,n.jsx)(r.RM,{children:e.activeSearch?e&&e.permissions.map(((s,a)=>s.searched&&(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{children:s.name.split("::")[2]}),(0,n.jsx)(r.pj,{className:"act",children:(0,n.jsx)(r.XZ,{value:s.name,checked:s.checked,onChange:a=>L(e.app.sk,s.name,a.currentTarget.checked)},s.name)})]},`item-${a}`))):e&&e.permissions.map(((s,a)=>(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{children:s.name.split("::")[2]}),(0,n.jsx)(r.pj,{className:"act",children:(0,n.jsx)(r.XZ,{value:s.name,checked:s.checked,onChange:a=>L(e.app.sk,s.name,a.currentTarget.checked)},s.name)})]},`item-${a}`)))})]})]})})})]},e.app.name),(0,n.jsx)("br",{})]})}))}),(0,n.jsx)("br",{}),(0,n.jsx)(r.iz,{vertical:30}),(0,n.jsx)(r.X2,{children:(0,n.jsxs)("div",{className:"form-bottom-action",children:[(0,n.jsx)(r.zx,{variant:"ghost",onClick:()=>{c.push("/iam/roles")},children:"Cancel"}),(0,n.jsx)(r.zx,{variant:"primary",type:"submit",disabled:z,children:"Save"})]})})]})}),T&&(0,n.jsx)("span",{children:T})]})})})})})},f=({role:e})=>{var s;const{t:a}=(0,r.$G)(),{can:i}=(0,l.useContext)(r.Il),c=(0,x.k6)(),d=(0,r.h_)(t.pH.IAM),{deleteResourceMeta:h,setDeleteResourceMeta:o}=(0,r.IJ)(),[p,m]=(0,l.useState)(!1),u=(i&&i("permission::iam::CAN_DELETE_ROLE"),i&&i("permission::iam::CAN_PATCH_ROLE"));return(0,l.useEffect)((()=>{m(!1)}),[h]),(0,n.jsx)(r.X2,{children:(0,n.jsx)(r.sg,{children:(0,n.jsxs)(r.Zb,{className:"network-content",page:!0,header:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.ZT,{h2:!0,children:a("General Information")}),(0,n.jsx)(r.Lt,{renderTrigger:(e,s,a)=>(0,n.jsx)(r.Kk,{ref:s,onClick:e,children:(0,n.jsx)(r.JO,{type:"ThreeDots",size:40})}),hasArrow:!0,placement:"right",children:(0,n.jsx)("div",{className:"ui-flex column network-action-dropdown",children:(0,n.jsxs)("div",{children:[u&&(0,n.jsxs)(r.zx,{className:"w-100",variant:"ghost",muted:!0,onClick:()=>{c.push(`/iam/roles/edit/${null==e?void 0:e.id}`)},children:[(0,n.jsx)(r.JO,{type:"Pen01",size:20,className:"mr-10"}),a("Manage")]}),u&&(0,n.jsxs)(r.zx,{className:"w-100",variant:"danger-ghost",muted:!0,onClick:()=>{null!=e&&e.id&&o({label:"role",resource:"roles",id:null==e?void 0:e.id})},children:[(0,n.jsx)(r.JO,{type:"Delete",size:20,className:"mr-10"}),a("Delete")]})]})})}),h&&(0,n.jsx)(r.QG,{meta:h,onClose:()=>{o(void 0)},onDelete:()=>{o(void 0),(0,r.hi)("Role deleted successfully",{type:"success"}),c.push("/iam/roles/list")},api:d}),p&&(0,n.jsx)(r.u_,{visible:p,onClose:()=>{m(!1)},style:{width:360},children:(0,n.jsxs)("div",{children:[(0,n.jsx)(r.ZT,{h2:!0,className:"ui-link-danger",children:a("Error")}),(0,n.jsx)(r.iz,{}),(0,n.jsx)(r.ZT,{size:"large",children:a("Delete associated role")}),(0,n.jsx)("div",{className:"ui-flex end mt-30",children:(0,n.jsx)(r.zx,{size:"large",variant:"ghost",onClick:()=>{m(!1)},children:a("Cancel")})})]})})]}),children:[(0,n.jsx)(r.X2,{children:(0,n.jsxs)("div",{className:"ui-flex column",children:[(0,n.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("Name")}),(0,n.jsx)(r.ZT,{children:null==e?void 0:e.name})]})}),(0,n.jsx)(r.X2,{children:(0,n.jsxs)("div",{className:"ui-flex column",children:[(0,n.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("Description")}),(0,n.jsx)(r.ZT,{children:null==e?void 0:e.description})]})}),e&&(null==(s=e.permissions)?void 0:s.length)>0&&(0,n.jsx)(r.X2,{children:(0,n.jsxs)("div",{className:"ui-flex column",children:[(0,n.jsx)(r.ZT,{size:"small",muted:!0,className:"pb-10",children:a("Permissions")}),e.permissions.map((e=>(0,n.jsx)(r.ZT,{children:e},e)))]})})]})})})},N=()=>{const e=(0,r.h_)(t.pH.IAM),s=(0,x.UO)(),[a,i]=(0,l.useState)(!0),[c,d]=(0,l.useState)();return(0,l.useEffect)((()=>{(async()=>{const a=await e.get(`/roles/${s.id}`);d(null==a?void 0:a.data.result),i(!1)})()}),[s.id]),a?(0,n.jsxs)(r.rj,{gutter:0,children:[(0,n.jsx)(r.Od,{className:"ml-10",parts:["header"]}),(0,n.jsxs)(r.Zb,{children:[(0,n.jsx)(r.Od,{parts:["title"]}),(0,n.jsx)(r.Od,{parts:["title"]}),(0,n.jsx)(r.Od,{parts:["title"]})]})]}):(0,n.jsx)(r.rj,{gutter:0,children:(0,n.jsx)(f,{role:c})})},y=()=>{var e,s;const a=(0,r.h_)(t.pH.IAM),c=(0,i.k6)(),[h,o]=(0,l.useState)(!0),[p,m]=(0,l.useState)([]),[x,u]=(0,l.useState)([]),[j,v]=(0,l.useState)(),[b,k]=(0,l.useState)(),[g,f]=(0,l.useState)(""),[N,y]=(0,l.useState)(""),[S,Z]=(0,l.useState)(""),[C,E]=(0,l.useState)(!1),[w,I]=(0,l.useState)(),{handleSubmit:O,formState:{errors:J}}=(0,d.cI)({defaultValues:{}});(0,r.N7)((()=>{const e=setTimeout((()=>{k(S)}),500);return()=>clearTimeout(e)}),[S]),(0,r.N7)((()=>{""!==b&&(async()=>{if(b){let e=await U(b.split("::")[0],b.split("::")[1]);(null==e?void 0:e.length)>0?T(b.split("::")[0],e):W(b.split("::")[0])}})()}),[b]),(0,l.useEffect)((()=>{o(!0);(async()=>{const e=(await a.get("/apps")).data.result||[];m(e)})(),o(!1)}),[]),(0,l.useEffect)((()=>{o(!0);(async()=>{let e=[],s=p.map((e=>null==e?void 0:e.sk));if(s&&s.length>0){var l,i;const r=await a.get(`/permissions?app=${s}`);null==r||null==(l=r.data)||null==(i=l.result)||i.map((s=>{e.push(s.sk)}))}u(e)})(),o(!1)}),[p]),(0,l.useEffect)((()=>{o(!0);let e=p.map((e=>{let s=[];return x.forEach((a=>{a&&a.split("::").includes(null==e?void 0:e.sk.split("::")[1])&&s.push({name:a,checked:!1,searched:!1})})),{allChecked:!1,app:{name:e.name,description:e.description,checked:!1,pk:null==e?void 0:e.pk,sk:null==e?void 0:e.sk},permissions:[...s],activeSearch:!1}}));v(e),o(!1)}),[p,x]);const Q=async(e,s,a)=>{let l=JSON.parse(JSON.stringify(j));l.forEach((l=>{var i;(null==(i=l.app)?void 0:i.sk)===e&&l.permissions&&l.permissions.forEach((e=>{(null==e?void 0:e.name)===s&&(e.checked=a)}))})),v(l)},z=(e,s)=>{let a=!0;return s&&s.forEach((s=>{s.app.sk===e&&s&&s.permissions&&s.permissions.forEach((e=>{e.checked||(a=!1)}))})),a},U=async(e,s)=>{var l;let i=await a.get(`/permissions/search?app=${e}&permission=${s}`),r=[];return i&&(null==(l=i.data.result)||l.map((e=>{r.push(e.sk)}))),r},T=async(e,s)=>{let a=JSON.parse(JSON.stringify(j));a.forEach((a=>{var l;(null==(l=a.app)?void 0:l.sk)===`app::${e}`&&(a.activeSearch=!1,a.permissions&&a.permissions.forEach((e=>{e.searched=!1,s.includes(null==e?void 0:e.name)&&(e.searched=!0,a.activeSearch=!0)})))})),v(a)},W=async e=>{let s=JSON.parse(JSON.stringify(j));s.forEach((s=>{var a;(null==(a=s.app)?void 0:a.sk)===`app::${e}`&&(s.permissions&&s.permissions.forEach((e=>{e.searched=!1})),s.activeSearch=!1)})),v(s)},L=e=>{let s=!0;return j&&j.forEach((a=>{a.app.sk===e&&a&&a.permissions&&a.permissions.forEach((e=>{e.checked||(s=!1)}))})),s};if(h)return(0,n.jsxs)(r.rj,{gutter:0,children:[(0,n.jsx)(r.Od,{className:"ml-10",parts:["header"]}),(0,n.jsxs)(r.Zb,{children:[(0,n.jsx)(r.Od,{parts:["title"]}),(0,n.jsx)(r.Od,{parts:["title"]}),(0,n.jsx)(r.Od,{parts:["title"]})]})]});return(0,n.jsx)(r.rj,{gutter:0,children:(0,n.jsx)(r.X2,{children:(0,n.jsx)(r.sg,{children:(0,n.jsx)(r.Zb,{className:"network-content",page:!0,header:(0,n.jsx)("div",{children:(0,n.jsx)(r.ZT,{h2:!0,children:"Create role"})}),children:(0,n.jsxs)(r.X2,{children:[(0,n.jsx)(r.sg,{offset:3,size:6,children:(0,n.jsxs)("form",{onSubmit:O((async()=>{try{let e=[];j&&j.forEach((s=>{s.permissions&&s.permissions.forEach((s=>{s&&s.checked&&e.push(null==s?void 0:s.name)}))})),await a.post("/roles",{name:g,description:N,permissions:e}),c.push("/iam/roles/list")}catch(w){I(w.response.data.error)}finally{E(!1)}})),children:[(0,n.jsx)(r.X2,{children:(0,n.jsx)(r.ZT,{h2:!0,children:"General Information"})}),(0,n.jsx)(r.iz,{}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{label:"Name",children:(0,n.jsx)(r.II,{placeholder:"name",error:null==J||null==(e=J.email)?void 0:e.message,onChange:e=>{f(e.target.value)}})}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{label:"Description",children:(0,n.jsx)(r.II,{placeholder:"Description",error:null==J||null==(s=J.display_name)?void 0:s.message,onChange:e=>{y(e.target.value)}})}),(0,n.jsx)("br",{}),(0,n.jsx)(r.iz,{}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{children:j&&j&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.ZT,{h2:!0,children:"Apps"}),(0,n.jsx)("br",{}),(0,n.jsxs)(r.iA,{children:[(0,n.jsx)(r.ss,{children:(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{as:"th",style:{width:50}}),(0,n.jsx)(r.pj,{as:"th",children:"App"})]})}),(0,n.jsx)(r.RM,{children:null==j?void 0:j.map(((e,s)=>(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{className:"act",children:(0,n.jsx)(r.XZ,{value:e.app.sk,checked:e.app.checked,onChange:s=>(async(e,s)=>{let a=JSON.parse(JSON.stringify(j));a.forEach((a=>{var l;(null==(l=a.app)?void 0:l.sk)===e&&(a.app.checked=s,s||a.permissions&&a.permissions.forEach((e=>{e.checked=s})))})),v(a)})(e.app.sk,s.currentTarget.checked)},s)}),(0,n.jsx)(r.pj,{children:e.app.sk.split("::")[1].charAt(0).toUpperCase()+e.app.sk.split("::")[1].slice(1)})]},`item-${s}`)))})]})]})}),(0,n.jsx)("br",{}),(0,n.jsx)(r.NI,{children:j&&j&&j.map((e=>{var s;return e&&e.app.checked&&(null==(s=e.permissions)?void 0:s.length)>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.zF,{title:e.app.sk.split("::")[1].charAt(0).toUpperCase()+e.app.sk.split("::")[1].slice(1),open:!0,children:[(0,n.jsx)(r.ZT,{p:!0,muted:!0,className:"p-20",children:"Added Privileges"}),(0,n.jsx)("div",{className:"network-toolbar v-center mb-20",children:(0,n.jsx)("div",{className:"mr-20",children:(0,n.jsxs)("div",{className:"pl-20 ui-filter-wrapper",children:[e&&e.permissions.map((s=>s&&s.checked?(0,n.jsx)(r.Af,{className:"mb-10",onClose:()=>Q(e.app.sk,s.name,!1),children:s.name.split("::")[2]},s.name):null)),(0,n.jsx)(r.X2,{children:(0,n.jsx)(r.II,{placeholder:"Search...",className:"mb-10",onChange:s=>Z(e.app.sk.split("::")[1]+"::"+s.target.value.toUpperCase())})}),(0,n.jsxs)(r.iA,{children:[(0,n.jsx)(r.ss,{children:(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{children:"Name"}),(0,n.jsx)(r.pj,{style:{width:50},children:(0,n.jsx)(r.XZ,{value:e.app.name,checked:L(e.app.sk),onChange:s=>(async(e,s)=>{let a=JSON.parse(JSON.stringify(j));a.forEach((l=>{l&&l.app.sk===e&&(l.app.checked=s,l.permissions&&l.permissions.forEach((e=>{e.checked=s})),l.allChecked=z(e,a))})),v(a)})(e.app.sk,s.currentTarget.checked)},e.app.name)})]})}),(0,n.jsx)(r.RM,{children:e.activeSearch?e&&e.permissions.map(((s,a)=>s.searched&&(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{children:s.name.split("::")[2]}),(0,n.jsx)(r.pj,{className:"act",children:(0,n.jsx)(r.XZ,{value:s.name,checked:s.checked,onChange:a=>Q(e.app.sk,s.name,a.currentTarget.checked)},s.name)})]},`item-${a}`))):e&&e.permissions.map(((s,a)=>(0,n.jsxs)(r.SC,{children:[(0,n.jsx)(r.pj,{children:s.name.split("::")[2]}),(0,n.jsx)(r.pj,{className:"act",children:(0,n.jsx)(r.XZ,{value:s.name,checked:s.checked,onChange:a=>Q(e.app.sk,s.name,a.currentTarget.checked)},s.name)})]},`item-${a}`)))})]})]})})})]},e.app.name),(0,n.jsx)("br",{})]})}))}),(0,n.jsx)("br",{}),(0,n.jsx)(r.iz,{vertical:30}),(0,n.jsx)(r.X2,{children:(0,n.jsxs)("div",{className:"form-bottom-action",children:[(0,n.jsx)(r.zx,{variant:"ghost",onClick:()=>{c.push("/iam/roles")},children:"Cancel"}),(0,n.jsx)(r.zx,{type:"submit",variant:"primary",disabled:C,children:"Create"})]})})]})}),w&&(0,n.jsx)("span",{children:w})]})})})})})};var S=a("vB0K"),Z=a.n(S),C=a("LOwH"),E=a.n(C),w=a("H/Mb"),I=a.n(w),O=a("MtWZ"),J=a.n(O),Q=a("j8Os"),z=a.n(Q),U=a("i/5k"),T=a.n(U),W=a("Tf7M"),L=a.n(W),A={};A.styleTagTransform=T(),A.setAttributes=J(),A.insert=I().bind(null,"head"),A.domAPI=E(),A.insertStyleElement=z();Z()(L(),A);L()&&L().locals&&L().locals;const F=()=>(0,n.jsxs)(i.rs,{children:[(0,n.jsx)(i.AW,{exact:!0,path:"/iam/users/list",children:(0,n.jsx)(c,{})}),(0,n.jsx)(i.AW,{exact:!0,path:"/iam/users/edit/:id",children:(0,n.jsx)(m,{})}),(0,n.jsx)(i.AW,{exact:!0,path:"/iam/users/create",children:(0,n.jsx)(b,{})}),(0,n.jsx)(i.AW,{exact:!0,path:"/iam/users/details/:id",children:(0,n.jsx)(j,{})})]}),X=()=>(0,n.jsxs)(i.rs,{children:[(0,n.jsx)(i.AW,{exact:!0,path:"/iam/roles/list",children:(0,n.jsx)(k,{})}),(0,n.jsx)(i.AW,{exact:!0,path:"/iam/roles/edit/:id",children:(0,n.jsx)(g,{})}),(0,n.jsx)(i.AW,{exact:!0,path:"/iam/roles/details/:id",children:(0,n.jsx)(N,{})}),(0,n.jsx)(i.AW,{exact:!0,path:"/iam/roles/create",children:(0,n.jsx)(y,{})})]}),G=({history:e})=>{const{setNavigation:s}=(0,l.useContext)(r.Il);return(0,l.useEffect)((()=>{s&&s(t.pH.IAM,[{name:"Users",path:"/iam/users/list",permission:!0},{name:"Roles",path:"/iam/roles/list",permission:!0}])}),[]),(0,n.jsx)(i.F0,{history:e,children:(0,n.jsx)(i.rs,{children:(0,n.jsx)(i.AW,{children:(0,n.jsxs)(i.rs,{children:[(0,n.jsx)(i.AW,{exact:!0,path:h,children:(0,n.jsx)(i.l_,{to:"/iam/users/list"})}),(0,n.jsx)(i.AW,{path:o,children:(0,n.jsx)(F,{})}),(0,n.jsx)(i.AW,{path:p,children:(0,n.jsx)(X,{})})]})})})})}},Tf7M:e=>{e.exports=[[e.id,".network-container{display:flex;flex-direction:column;height:100%;width:100%}.network-container .network-content+.network-content{margin-top:10px}.network-content{width:100%;flex:1}.network-content>.butler-row{margin-top:0}.toolbar{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:20px 30px}.butler-row+.butler-row{margin-top:0}.form-bottom-action{display:flex;flex-direction:row;align-items:center;justify-content:flex-end}.form-bottom-action>.ui-btn+.ui-btn{margin-left:10px}.network-sidebar-wrapper .ui-btn+.ui-btn{margin-top:10px}.network-sidebar-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:15px}.network-link-no-underline{text-decoration:none !important;cursor:pointer}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0eWxlcy5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLG1CQUFtQixZQUFZLENBQUMscUJBQXFCLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxxREFBcUQsZUFBZSxDQUFDLGlCQUFpQixVQUFVLENBQUMsTUFBTSxDQUFDLDZCQUE2QixZQUFZLENBQUMsU0FBUyxZQUFZLENBQUMsa0JBQWtCLENBQUMsa0JBQWtCLENBQUMsNkJBQTZCLENBQUMsaUJBQWlCLENBQUMsd0JBQXdCLFlBQVksQ0FBQyxvQkFBb0IsWUFBWSxDQUFDLGtCQUFrQixDQUFDLGtCQUFrQixDQUFDLHdCQUF3QixDQUFDLG9DQUFvQyxnQkFBZ0IsQ0FBQyx5Q0FBeUMsZUFBZSxDQUFDLHdCQUF3QixZQUFZLENBQUMsa0JBQWtCLENBQUMsNkJBQTZCLENBQUMsa0JBQWtCLENBQUMsMkJBQTJCLCtCQUErQixDQUFDLGNBQWMiLCJmaWxlIjoic3R5bGVzLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIubmV0d29yay1jb250YWluZXJ7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlfS5uZXR3b3JrLWNvbnRhaW5lciAubmV0d29yay1jb250ZW50Ky5uZXR3b3JrLWNvbnRlbnR7bWFyZ2luLXRvcDoxMHB4fS5uZXR3b3JrLWNvbnRlbnR7d2lkdGg6MTAwJTtmbGV4OjF9Lm5ldHdvcmstY29udGVudD4uYnV0bGVyLXJvd3ttYXJnaW4tdG9wOjB9LnRvb2xiYXJ7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOnJvdzthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47cGFkZGluZzoyMHB4IDMwcHh9LmJ1dGxlci1yb3crLmJ1dGxlci1yb3d7bWFyZ2luLXRvcDowfS5mb3JtLWJvdHRvbS1hY3Rpb257ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOnJvdzthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kfS5mb3JtLWJvdHRvbS1hY3Rpb24+LnVpLWJ0bisudWktYnRue21hcmdpbi1sZWZ0OjEwcHh9Lm5ldHdvcmstc2lkZWJhci13cmFwcGVyIC51aS1idG4rLnVpLWJ0bnttYXJnaW4tdG9wOjEwcHh9Lm5ldHdvcmstc2lkZWJhci1oZWFkZXJ7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjttYXJnaW4tYm90dG9tOjE1cHh9Lm5ldHdvcmstbGluay1uby11bmRlcmxpbmV7dGV4dC1kZWNvcmF0aW9uOm5vbmUgIWltcG9ydGFudDtjdXJzb3I6cG9pbnRlcn0iXX0= */","",""]]}}]);